<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><title>Simulate a spatial normal (Gaussian) random variable — sprnorm • spmodel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a spatial normal (Gaussian) random variable — sprnorm"><meta property="og:description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basics.html">An Overview of Basic Features in spmodel</a>
    <a class="dropdown-item" href="../articles/guide.html">A Detailed Guide to spmodel</a>
    <a class="dropdown-item" href="../articles/technical.html">Technical Details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/spmodel/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a spatial normal (Gaussian) random variable</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/R/sprnorm.R" class="external-link"><code>R/sprnorm.R</code></a></small>
      <div class="d-none name"><code>sprnorm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for exponential</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">xcoord</span>,</span>
<span>  <span class="va">ycoord</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for none</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for car</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  row_st <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>spcov_params</dt>
<dd><p>An <code><a href="spcov_params.html">spcov_params()</a></code> object.</p></dd>


<dt>mean</dt>
<dd><p>A numeric vector representing the mean. <code>mean</code> must have length 1
(in which case it is recycled) or length equal
to the number of rows in <code>data</code>. The default is <code>0</code>.</p></dd>


<dt>samples</dt>
<dd><p>The number of independent samples to generate. The default
is <code>1</code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame or <code>sf</code> object containing spatial information.</p></dd>


<dt>randcov_params</dt>
<dd><p>A <code><a href="randcov_params.html">randcov_params()</a></code> object.</p></dd>


<dt>partition_factor</dt>
<dd><p>A formula indicating the partition factor.</p></dd>


<dt>...</dt>
<dd><p>Other arguments. Not used (needed for generic consistency).</p></dd>


<dt>xcoord</dt>
<dd><p>Name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>ycoord</dt>
<dd><p>Name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>W</dt>
<dd><p>Weight matrix specifying the neighboring structure used for car and
sar models. Not required if <code>data</code> are an <code>sf</code>
polygon object and <code>W</code> should be calculated internally.</p></dd>


<dt>row_st</dt>
<dd><p>A logical indicating whether row standardization be performed on
<code>W</code>. The default is <code>TRUE</code>.</p></dd>


<dt>M</dt>
<dd><p>M matrix satisfying the car symmetry condition. The car
symmetry condition states that \((I - range * W)^{-1}M\) is symmetric, where
\(I\) is an identity matrix, \(range\) is a constant that controls the
spatial dependence, <code>W</code> is the weights matrix,
and \(^{-1}\) represents the inverse operator.
<code>M</code> is required for car models
when <code>W</code> is provided and <code>row_st</code> is <code>FALSE</code>.  When <code>M</code>,
is required, the default is the identity matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>samples</code> is 1, a vector of random variables for each row of <code>data</code></p>


<p>is returned. If <code>samples</code> is greater than one, a matrix of random variables
is returned, where the rows correspond to each row of <code>data</code> and the columns
correspond to independent samples.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Random variables are simulated via the product of the covariance matrix's
square (Cholesky) root and independent standard normal random variables
with mean 0 and variance 1. Computing the square root is a significant
computational burden and likely unfeasible for sample sizes much past 10,000.
Because this square root only needs to be computed once, however, it is
nearly the sample computational cost to call <code>sprnorm()</code> for any value
of <code>samples</code>.</p>
<p>Only methods for the <code>exponential</code>, <code>none</code>, and <code>car</code>
covariance functions are documented here,
but methods exist for all other spatial covariance functions defined in
<code><a href="spcov_initial.html">spcov_initial()</a></code>. Syntax for the <code>exponential</code> method is the same
as syntax for <code>spherical</code>, <code>gaussian</code>, <code>triangular</code>,
<code>circular</code>, <code>cubic</code>, <code>pentaspherical</code>, <code>cosine</code>, <code>wave</code>,
<code>jbessel</code>, <code>gravity</code>, <code>rquad</code>, <code>magnetic</code>, <code>matern</code>,
<code>cauchy</code>, and <code>pexponential</code> methods. Syntax for
the <code>car</code> method is the same as syntax for the <code>sar</code> method. The
<code>extra</code> parameter for car and sar models is ignored when all observations have
neighbors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spcov_params_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="spcov_params.html">spcov_params</a></span><span class="op">(</span><span class="st">"exponential"</span>, de <span class="op">=</span> <span class="fl">1</span>, ie <span class="op">=</span> <span class="fl">1</span>, range <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -0.4141798947  0.8754033261  0.9909964440 -1.6854436981 -0.7177066662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]  0.7221768068  1.0608685327 -0.4455809628 -0.0358468581 -1.2331012441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] -0.0121050047  0.6825719401  1.8885684238  3.2357646562 -0.3236846424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]  0.0008987733  0.9830467100  1.7653545195  3.2190882541  0.4528468185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] -1.1291504579 -0.5011889270  1.1625324029 -2.3406347555 -0.3694399139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  0.2055746001  0.2298870777  2.8240301690  1.6138756655 -1.6500186891</span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, samples <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]       [,3]       [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.229153  1.462321  2.2411053 -0.1408958  0.2325348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.529805  2.672669  0.5342035  3.2138382  1.6346942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.650417  2.045490  2.2851819  3.2086407  1.9227771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  3.534750  6.396168  4.0019210  4.0071680  4.4084278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  6.966512  7.146783  3.3932743  6.9847530  4.6629422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  8.380621  6.742105  6.5885822  3.9309706  6.0593199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  8.053691  7.309490  6.8026510  4.8531421  7.2892191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  9.086599  8.052997  7.1165832  8.4161032  7.8817427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 12.508193  9.388723  8.3195101  8.9181296 10.2966378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 12.614975 11.788532 13.4153772 11.4733615  9.4826048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 10.270888  9.830519 11.5702429 10.9913194 10.7931955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 10.292714 12.372273 11.5235581 11.1753656 12.4044837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 12.019957 11.354008 10.0455471 14.9210061 13.6580889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 14.732081 14.392766 12.7755348 14.7802836 14.9542733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 15.730486 16.094785 15.7316027 15.4354447 16.1953193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 14.462285 13.331054 18.1387870 17.0072061 15.4240054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 17.123930 16.974889 17.2568705 17.7215753 14.7114688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 14.790494 18.594710 15.9820744 17.5011687 17.9936770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 20.612240 21.739544 16.6765675 21.0562899 20.2412626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 22.441689 21.982433 18.5820632 23.1674380 21.0176501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 20.964724 21.175957 21.9097190 22.8648442 22.7448473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 20.929465 22.381041 21.8282337 20.5903964 21.5601355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 22.503227 24.099690 23.8567381 21.9887783 22.5044018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] 25.853218 25.098367 24.8439059 23.8845485 25.1315176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] 27.326652 25.147286 25.8221885 25.1024889 25.7186829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] 24.142632 25.089201 29.3006111 25.6247783 27.1157621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] 27.722113 28.097002 29.4875980 27.2047036 25.7655944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] 29.460726 29.891445 27.8690744 25.6065189 30.1559171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] 29.009647 29.356898 26.1648700 29.5369171 30.0284159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] 33.147983 29.479773 30.8956972 28.4501954 29.4671703</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

