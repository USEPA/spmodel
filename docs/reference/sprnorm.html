<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate a spatial normal (Gaussian) random variable — sprnorm • spmodel</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a spatial normal (Gaussian) random variable — sprnorm"><meta property="og:description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><meta property="og:image" content="https://usepa.github.io/spmodel/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">An Introduction to spmodel</a>
    </li>
    <li>
      <a href="../articles/guide.html">A Detailed Guide to spmodel</a>
    </li>
    <li>
      <a href="../articles/SPGLMs.html">Spatial Generalized Linear Models in spmodel</a>
    </li>
    <li>
      <a href="../articles/emmeans.html">Using emmeans to Estimate Marginal Means of spmodel Objects</a>
    </li>
    <li>
      <a href="../articles/technical.html">Technical Details</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USEPA/spmodel/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a spatial normal (Gaussian) random variable</h1>
    <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/R/sprnorm.R" class="external-link"><code>R/sprnorm.R</code></a></small>
    <div class="hidden name"><code>sprnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for exponential</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">xcoord</span>,</span>
<span>  <span class="va">ycoord</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for none</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for ie</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for car</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  row_st <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spcov_params</dt>
<dd><p>An <code><a href="spcov_params.html">spcov_params()</a></code> object.</p></dd>


<dt>mean</dt>
<dd><p>A numeric vector representing the mean. <code>mean</code> must have length 1
(in which case it is recycled) or length equal
to the number of rows in <code>data</code>. The default is <code>0</code>.</p></dd>


<dt>samples</dt>
<dd><p>The number of independent samples to generate. The default
is <code>1</code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame or <code>sf</code> object containing spatial information.</p></dd>


<dt>randcov_params</dt>
<dd><p>A <code><a href="randcov_params.html">randcov_params()</a></code> object.</p></dd>


<dt>partition_factor</dt>
<dd><p>A formula indicating the partition factor.</p></dd>


<dt>...</dt>
<dd><p>Other arguments. Not used (needed for generic consistency).</p></dd>


<dt>xcoord</dt>
<dd><p>Name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>ycoord</dt>
<dd><p>Name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>W</dt>
<dd><p>Weight matrix specifying the neighboring structure used for car and
sar models. Not required if <code>data</code> are an <code>sf</code>
polygon object and <code>W</code> should be calculated internally (using queen contiguity).</p></dd>


<dt>row_st</dt>
<dd><p>A logical indicating whether row standardization be performed on
<code>W</code>. The default is <code>TRUE</code>.</p></dd>


<dt>M</dt>
<dd><p>M matrix satisfying the car symmetry condition. The car
symmetry condition states that \((I - range * W)^{-1}M\) is symmetric, where
\(I\) is an identity matrix, \(range\) is a constant that controls the
spatial dependence, <code>W</code> is the weights matrix,
and \(^{-1}\) represents the inverse operator.
<code>M</code> is required for car models
when <code>W</code> is provided and <code>row_st</code> is <code>FALSE</code>.  When <code>M</code>,
is required, the default is the identity matrix.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>samples</code> is 1, a vector of random variables for each row of <code>data</code></p>


<p>is returned. If <code>samples</code> is greater than one, a matrix of random variables
is returned, where the rows correspond to each row of <code>data</code> and the columns
correspond to independent samples.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Random variables are simulated via the product of the covariance matrix's
square (Cholesky) root and independent standard normal random variables
with mean 0 and variance 1. Computing the square root is a significant
computational burden and likely unfeasible for sample sizes much past 10,000.
Because this square root only needs to be computed once, however, it is
nearly the sample computational cost to call <code>sprnorm()</code> for any value
of <code>samples</code>.</p>
<p>Only methods for the <code>exponential</code>, <code>none</code>, and <code>car</code>
covariance functions are documented here,
but methods exist for all other spatial covariance functions defined in
<code><a href="spcov_initial.html">spcov_initial()</a></code>. Syntax for the <code>exponential</code> method is the same
as syntax for <code>spherical</code>, <code>gaussian</code>, <code>triangular</code>,
<code>circular</code>, <code>cubic</code>, <code>pentaspherical</code>, <code>cosine</code>, <code>wave</code>,
<code>jbessel</code>, <code>gravity</code>, <code>rquad</code>, <code>magnetic</code>, <code>matern</code>,
<code>cauchy</code>, and <code>pexponential</code> methods. Syntax for
the <code>car</code> method is the same as syntax for the <code>sar</code> method. The
<code>extra</code> parameter for car and sar models is ignored when all observations have
neighbors.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spcov_params_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="spcov_params.html">spcov_params</a></span><span class="op">(</span><span class="st">"exponential"</span>, de <span class="op">=</span> <span class="fl">1</span>, ie <span class="op">=</span> <span class="fl">1</span>, range <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.7295330 -0.1464557 -0.6440707  0.6846085 -1.0265109  1.0855714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  0.4864720 -0.6086310 -0.6648226  1.2126239  1.1669871  1.3339350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  0.5193776  1.3132474 -0.2588738  0.7270756 -0.2675173  2.4908294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  1.1697255 -0.4819587  0.1402007 -0.6007224  2.6260628  2.3593206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] -1.2412009 -0.3532930 -2.0020151  0.3291695 -1.1167337  0.5067219</span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, samples <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]       [,3]       [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.6826043  0.03645854  0.5418698 -0.9583461 -0.9407780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -0.3475714  1.07867458  2.8647890  1.2259798  0.2757822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  1.4192099  3.57972869  1.8585750  3.8140107  1.5220003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  5.7859837  6.46258424  2.0783939  3.6029321  2.3611136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  4.8314165  7.28339629  5.2239981  4.1732668  4.8750043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  3.9052040  5.02831125  4.9407409  5.2405835  7.1770119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  4.0811976  8.62503780  6.2341917  7.5103071  5.2324641</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  7.6099946  7.38567557  8.1745419  8.0192062  7.1591082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  9.6443881  8.93477189  9.9143297  7.2800348  8.0556939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 11.1737062 10.54551342  9.5474115  9.4969713 10.4015801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 10.6457242 12.91474090 10.5644616 10.0171602 10.3333953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 10.9550519 11.30757591 12.4383081 11.2161272 12.2723014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 14.7887060 12.89027226 14.4906696 13.4813033 13.3166775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 12.2561885 12.81773362 15.4710743 12.5490735 14.0731488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 13.6222303 14.41096493 13.3685912 12.4559545 13.4177200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 15.5565348 15.28052745 16.7505130 15.7552921 16.7151686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 15.9511689 18.18521355 17.1905893 16.2667766 16.2584423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 18.5378461 17.70817096 18.7072022 20.3020913 18.3316137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 19.4339331 17.23963728 18.9809522 19.4549497 18.7934473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 19.0473645 20.16644781 20.6129162 20.5602634 19.9818491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 21.5359177 22.25259498 20.1363655 20.6932762 20.3953194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 21.3121090 22.64364461 21.9117288 21.5527441 20.9678691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 24.3641973 21.91184919 25.8638034 23.3035162 24.2698395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] 23.4176948 22.74474825 26.0934353 24.5857354 24.6562789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] 22.3106568 24.03093980 23.8808282 24.0220256 25.8209420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] 24.6157656 27.58248741 23.7597144 26.4362438 26.5329806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] 24.7461919 28.53420016 27.8781392 27.5560128 25.3986703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] 29.2483577 26.81614702 29.8974594 29.0680694 28.8898464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] 28.5834952 28.22743999 28.6159507 29.8020352 27.9987930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] 30.8567576 30.57729558 27.5115180 31.2970567 30.3425222</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

