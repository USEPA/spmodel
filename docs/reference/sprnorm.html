<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate a spatial normal (Gaussian) random variable — sprnorm • spmodel</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a spatial normal (Gaussian) random variable — sprnorm"><meta property="og:description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><meta property="og:image" content="https://usepa.github.io/spmodel/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">An Introduction to spmodel</a>
    </li>
    <li>
      <a href="../articles/guide.html">A Detailed Guide to spmodel</a>
    </li>
    <li>
      <a href="../articles/SPGLMs.html">Spatial Generalized Linear Models in spmodel</a>
    </li>
    <li>
      <a href="../articles/emmeans.html">Using emmeans to Estimate Marginal Means of spmodel Objects</a>
    </li>
    <li>
      <a href="../articles/technical.html">Technical Details</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USEPA/spmodel/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a spatial normal (Gaussian) random variable</h1>
    <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/R/sprnorm.R" class="external-link"><code>R/sprnorm.R</code></a></small>
    <div class="hidden name"><code>sprnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for exponential</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">xcoord</span>,</span>
<span>  <span class="va">ycoord</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for none</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for car</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  row_st <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spcov_params</dt>
<dd><p>An <code><a href="spcov_params.html">spcov_params()</a></code> object.</p></dd>


<dt>mean</dt>
<dd><p>A numeric vector representing the mean. <code>mean</code> must have length 1
(in which case it is recycled) or length equal
to the number of rows in <code>data</code>. The default is <code>0</code>.</p></dd>


<dt>samples</dt>
<dd><p>The number of independent samples to generate. The default
is <code>1</code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame or <code>sf</code> object containing spatial information.</p></dd>


<dt>randcov_params</dt>
<dd><p>A <code><a href="randcov_params.html">randcov_params()</a></code> object.</p></dd>


<dt>partition_factor</dt>
<dd><p>A formula indicating the partition factor.</p></dd>


<dt>...</dt>
<dd><p>Other arguments. Not used (needed for generic consistency).</p></dd>


<dt>xcoord</dt>
<dd><p>Name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>ycoord</dt>
<dd><p>Name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>W</dt>
<dd><p>Weight matrix specifying the neighboring structure used for car and
sar models. Not required if <code>data</code> are an <code>sf</code>
polygon object and <code>W</code> should be calculated internally (using queen contiguity).</p></dd>


<dt>row_st</dt>
<dd><p>A logical indicating whether row standardization be performed on
<code>W</code>. The default is <code>TRUE</code>.</p></dd>


<dt>M</dt>
<dd><p>M matrix satisfying the car symmetry condition. The car
symmetry condition states that \((I - range * W)^{-1}M\) is symmetric, where
\(I\) is an identity matrix, \(range\) is a constant that controls the
spatial dependence, <code>W</code> is the weights matrix,
and \(^{-1}\) represents the inverse operator.
<code>M</code> is required for car models
when <code>W</code> is provided and <code>row_st</code> is <code>FALSE</code>.  When <code>M</code>,
is required, the default is the identity matrix.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>samples</code> is 1, a vector of random variables for each row of <code>data</code></p>


<p>is returned. If <code>samples</code> is greater than one, a matrix of random variables
is returned, where the rows correspond to each row of <code>data</code> and the columns
correspond to independent samples.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Random variables are simulated via the product of the covariance matrix's
square (Cholesky) root and independent standard normal random variables
with mean 0 and variance 1. Computing the square root is a significant
computational burden and likely unfeasible for sample sizes much past 10,000.
Because this square root only needs to be computed once, however, it is
nearly the sample computational cost to call <code>sprnorm()</code> for any value
of <code>samples</code>.</p>
<p>Only methods for the <code>exponential</code>, <code>none</code>, and <code>car</code>
covariance functions are documented here,
but methods exist for all other spatial covariance functions defined in
<code><a href="spcov_initial.html">spcov_initial()</a></code>. Syntax for the <code>exponential</code> method is the same
as syntax for <code>spherical</code>, <code>gaussian</code>, <code>triangular</code>,
<code>circular</code>, <code>cubic</code>, <code>pentaspherical</code>, <code>cosine</code>, <code>wave</code>,
<code>jbessel</code>, <code>gravity</code>, <code>rquad</code>, <code>magnetic</code>, <code>matern</code>,
<code>cauchy</code>, and <code>pexponential</code> methods. Syntax for
the <code>car</code> method is the same as syntax for the <code>sar</code> method. The
<code>extra</code> parameter for car and sar models is ignored when all observations have
neighbors.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spcov_params_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="spcov_params.html">spcov_params</a></span><span class="op">(</span><span class="st">"exponential"</span>, de <span class="op">=</span> <span class="fl">1</span>, ie <span class="op">=</span> <span class="fl">1</span>, range <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -0.06980081 -0.68020627 -0.56886464 -0.26815128 -1.01535060  2.33551655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -0.44967057 -1.92889316 -1.63504814 -2.32871896  1.93289443  1.85437674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] -1.55763216 -1.20003818 -2.16023906 -0.28367420  1.60990348  0.30700052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] -1.05285940 -3.05679064 -0.19894495  4.34957221  0.15534697 -0.78244287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] -2.39471474  2.95632391  0.94821654  0.43928418 -1.57004380  0.89329132</span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, samples <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]      [,3]      [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.078090  1.3147187  1.441157  2.124264  0.5462837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.840552  0.2225271  1.685848  2.586706  4.0892017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  6.115456  4.5206299  5.159078  4.402004  1.1861009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.783873  3.1979665  5.672752  3.679482  2.3481716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  5.190463  3.6040938  6.630187  5.375776  4.4039315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  8.025303  6.6460794  4.857592  5.557943  5.1827048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  4.890117  7.3494126  6.591105  9.463003  7.6571161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  9.603237  6.6343564  6.693872  9.185765  8.4138987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  9.388534  7.8719517  8.660903  8.534503  7.9407269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 10.928985  7.4975513 11.436805  9.949048 10.3371819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 12.374689  8.9616718 12.231921 10.300568 10.2829292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 12.195869 11.5621364 12.928044 14.589577 13.3807373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 15.608122 12.8850120 13.926398 15.352861 12.4245765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 14.198620 13.0868805 14.133952 12.762481 11.3430095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 14.799059 15.0785857 13.979685 14.438695 13.1587026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 16.307745 17.8768995 12.218104 13.984914 13.8725352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 14.574256 15.6592328 18.465883 17.309888 18.2788915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 16.288000 17.9217261 18.870794 16.868634 17.5694213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 17.119627 19.3590533 17.479299 19.474120 19.7600068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 18.946611 20.4888340 20.398798 21.530128 18.7400504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 21.124212 20.0470900 20.281633 18.049198 20.0074259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 21.046118 22.6511808 21.296460 20.258446 22.6361451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 21.080317 23.1293510 23.742695 24.728682 25.4201797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] 21.584540 24.3182510 22.871521 23.912125 26.0899007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] 24.717717 24.4614129 25.786639 23.123184 24.4012597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] 26.026392 27.1471721 26.111566 23.031574 27.7883921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] 27.592915 31.8283411 26.266823 26.528206 26.4244062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] 30.205454 30.5862874 27.328975 28.569603 27.8954187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] 30.003495 29.5748153 30.263001 30.023616 29.4048819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] 28.712228 29.4849548 31.163288 30.137724 32.0432562</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

