<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit spatial linear models for point-referenced data (i.e.,
geostatistical models) using
a variety of estimation methods, allowing for random effects,
anisotropy, partition factors, and big data methods."><title>Fit spatial linear models — splm • spmodel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit spatial linear models — splm"><meta property="og:description" content="Fit spatial linear models for point-referenced data (i.e.,
geostatistical models) using
a variety of estimation methods, allowing for random effects,
anisotropy, partition factors, and big data methods."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basics.html">An Overview of Basic Features in spmodel</a>
    <a class="dropdown-item" href="../articles/guide.html">A Detailed Guide to spmodel</a>
    <a class="dropdown-item" href="../articles/technical.html">Technical Details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/spmodel/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit spatial linear models</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/R/splm.R" class="external-link"><code>R/splm.R</code></a></small>
      <div class="d-none name"><code>splm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit spatial linear models for point-referenced data (i.e.,
geostatistical models) using
a variety of estimation methods, allowing for random effects,
anisotropy, partition factors, and big data methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">splm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">spcov_type</span>,</span>
<span>  <span class="va">xcoord</span>,</span>
<span>  <span class="va">ycoord</span>,</span>
<span>  <span class="va">spcov_initial</span>,</span>
<span>  estmethod <span class="op">=</span> <span class="st">"reml"</span>,</span>
<span>  weights <span class="op">=</span> <span class="st">"cressie"</span>,</span>
<span>  anisotropy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">random</span>,</span>
<span>  <span class="va">randcov_initial</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">local</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>A two-sided linear formula describing the fixed effect structure
of the model, with the response to the left of the <code>~</code> operator and
the terms on the right, separated by <code>+</code> operators.</p></dd>


<dt>data</dt>
<dd><p>A data frame or <code>sf</code> object object that contains
the variables in <code>fixed</code>, <code>random</code>, and <code>partition_factor</code>
as well as geographical information. If an <code>sf</code> object is
provided with <code>POINT</code> geometries, the x-coordinates and y-coordinates
are used directly. If an <code>sf</code> object is
provided with <code>POLYGON</code> geometries, the x-coordinates and y-coordinates
are taken as the centroids of each polygon.</p></dd>


<dt>spcov_type</dt>
<dd><p>The spatial covariance type. Available options include
<code>"exponential"</code>, <code>"spherical"</code>, <code>"gaussian"</code>,
<code>"triangular"</code>, <code>"circular"</code>, <code>"cubic"</code>,
<code>"pentaspherical"</code>, <code>"cosine"</code>, <code>"wave"</code>,
<code>"jbessel"</code>, <code>"gravity"</code>, <code>"rquad"</code>,
<code>"magnetic"</code>, <code>"matern"</code>, <code>"cauchy"</code>, <code>"pexponential"</code>,
and <code>"none"</code>. Parameterizations of each spatial covariance type are
available in Details. Multiple spatial covariance types can be provided as
a character vector, and then <code>splm()</code> is called iteratively for each
element and a list is returned for each model fit. The default for
<code>spcov_type</code> is <code>"exponential"</code>. When <code>spcov_type</code> is
specified, all unknown spatial covariance parameters are estimated.
<code>spcov_type</code> is ignored if <code>spcov_initial</code> is provided.</p></dd>


<dt>xcoord</dt>
<dd><p>The name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> is an <code>sf</code> object.</p></dd>


<dt>ycoord</dt>
<dd><p>The name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> is an <code>sf</code> object.</p></dd>


<dt>spcov_initial</dt>
<dd><p>An object from <code><a href="spcov_initial.html">spcov_initial()</a></code> specifying initial and/or
known values for the spatial covariance parameters. Multiple <code><a href="spcov_initial.html">spcov_initial()</a></code>
objects can be provided in a list. Then <code>splm()</code> is called iteratively
for each element and a list is returned for each model fit.</p></dd>


<dt>estmethod</dt>
<dd><p>The estimation method. Available options include
<code>"reml"</code> for restricted maximum likelihood, <code>"ml"</code> for maximum
likelihood, <code>"sv-wls"</code> for semivariogram weighted least squares,
and <code>"sv-cl"</code> for semivariogram composite likelihood. The default is
<code>"reml"</code>.</p></dd>


<dt>weights</dt>
<dd><p>Weights to use when <code>estmethod</code> is <code>"sv-wls"</code>. Available
options include <code>"cressie"</code>, <code>"cressie-dr"</code>, <code>"cressie-nopairs"</code>,
<code>"cressie-dr-nopairs"</code>, <code>"pairs"</code>, <code>"pairs-invd"</code>,
<code>"pairs-invrd"</code>, and <code>"ols"</code>. Parameterizations for each weight
are available in Details. The default is <code>"cressie"</code>.</p></dd>


<dt>anisotropy</dt>
<dd><p>A logical indicating whether (geometric) anisotropy should
be modeled. Not required if <code>spcov_initial</code> is provided with 1) <code>rotate</code>
assumed unknown or assumed known and non-zero or 2) <code>scale</code> assumed unknown
or assumed known and less than one. When <code>anisotropy</code> is <code>TRUE</code>,
computational times can significantly increase. The default is <code>FALSE</code>.</p></dd>


<dt>random</dt>
<dd><p>A one-sided linear formula describing the random effect structure
of the model. Terms are specified to the right of the <code>~ operator</code>.
Each term has the structure <code>x1 + ... + xn | g1/.../gm</code>, where <code>x1 + ... + xn</code>
specifies the model for the random effects and <code>g1/.../gm</code> is the grouping
structure. Separate terms are separated by <code>+</code> and must generally
be wrapped in parentheses. Random intercepts are added to each model
implicitly when at least  one other variable is defined.
If a random intercept is not desired, this must be explicitly
defined (e.g., <code>x1 + ... + xn - 1 | g1/.../gm</code>). If only a random intercept
is desired for a grouping structure, the random intercept must be specified
as <code>1 | g1/.../gm</code>. Note that <code>g1/.../gm</code> is shorthand for <code>(1 | g1/.../gm)</code>.
If only random intercepts are desired and the shorthand notation is used,
parentheses can be omitted.</p></dd>


<dt>randcov_initial</dt>
<dd><p>An optional object specifying initial and/or
known values for the random effect variances.</p></dd>


<dt>partition_factor</dt>
<dd><p>A one-sided linear formula with a single term
specifying the partition factor.  The partition factor assumes observations
from different levels of the partition factor are uncorrelated.</p></dd>


<dt>local</dt>
<dd><p>An optional logical or list controlling the big data approximation.
If omitted, <code>local</code> is set
to <code>TRUE</code> or <code>FALSE</code> based on the sample size (the number of
non-missing observations in <code>data</code>) -- if the sample size exceeds 5,000,
<code>local</code> is set to <code>TRUE</code>. Otherwise it is set to <code>FALSE</code>.
If <code>FALSE</code>, no big data approximation is implemented.
If a list is provided, the following arguments detail the big
data approximation:</p><ul><li><p><code>index: </code>The group indexes. Observations in different
levels of <code>index</code> are assumed to be uncorrelated for the
purposes of estimation. If <code>index</code> is not provided, it is
determined by specifying <code>method</code> and either <code>size</code> or <code>groups</code>.</p></li>
<li><p><code>method</code>: The big data approximation method used to determine <code>index</code>. Ignored
if <code>index</code> is provided. If <code>method = "random"</code>,
observations are randomly assigned to <code>index</code> based on <code>size</code>.
If <code>method = "kmeans"</code>, observations assigned to <code>index</code>
based on k-means clustering on the coordinates with <code>groups</code> clusters. The default
is <code>"random"</code>. Note that both methods have a random component, which
means that you may get different results from separate model fitting calls.
To ensure consistent results, specify <code>index</code> or set a seed via
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">base::set.seed()</a></code>.</p></li>
<li><p><code>size</code>: The number of observations in each <code>index</code> group
when <code>method</code> is <code>"random"</code>. If the number of observations
is not divisible by <code>size</code>, some levels get <code>size - 1</code> observations.
The default is 50.</p></li>
<li><p><code>groups: </code>The number of <code>index</code> groups. If <code>method</code>
is <code>"random"</code>, <code>size</code> is \(ceiling(n / groups)\), where
\(n\) is the sample size. Automatically determined if <code>size</code>
is specified. If <code>method</code> is <code>"kmeans"</code>, <code>groups</code>
is the number of clusters.</p></li>
<li><p><code>var_adjust: </code>The approach for adjusting the variance-covariance
matrix of the fixed effects. <code>"none"</code> for no adjustment, <code>"theoretical"</code>
for the theoretically-correct adjustment,
<code>"pooled"</code> for the pooled adjustment, and <code>"empirical"</code> for the
empirical adjustment. The default is <code>"theoretical"</code>.</p></li>
<li><p><code>parallel</code>: If <code>TRUE</code>, parallel processing via the
parallel package is automatically used. The default is <code>FALSE</code>.</p></li>
<li><p><code>ncores</code>: If <code>parallel = TRUE</code>, the number of cores to
parallelize over. The default is the number of available cores on your machine.</p></li>
</ul><p>When <code>local</code> is a list, at least one list element must be provided to
initialize default arguments for the other list elements.
If <code>local</code> is <code>TRUE</code>, defaults for <code>local</code> are chosen such
that <code>local</code> is transformed into
<code>list(size = 50, method = "random", var_adjust = "theoretical", parallel = FALSE)</code>.</p></dd>


<dt>...</dt>
<dd><p>Other arguments to <code><a href="esv.html">esv()</a></code> or <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with many elements that store information about
the fitted model object. If <code>spcov_type</code> or <code>spcov_initial</code> are
length one, the list has class <code>spmod</code>. Many generic functions that
summarize model fit are available for <code>spmod</code> objects, including
<code>AIC</code>, <code>AICc</code>, <code>anova</code>, <code>augment</code>, <code>coef</code>,
<code>cooks.distance</code>, <code>deviance</code>, <code>fitted</code>, <code>formula</code>,
<code>glance</code>, <code>glances</code>, <code>hatvalues</code>, <code>influence</code>,
<code>labels</code>, <code>logLik</code>, <code>loocv</code>, <code>model.frame</code>, <code>model.matrix</code>,
<code>plot</code>, <code>predict</code>, <code>print</code>, <code>pseudoR2</code>, <code>summary</code>,
<code>terms</code>, <code>tidy</code>, <code>update</code>, and <code>vcov</code>. If
<code>spcov_type</code> or <code>spcov_initial</code> are length greater than one, the
list has class <code>spmod_list</code> and each element in the list has class
<code>spmod</code>. <code>glances</code> can be used to summarize <code>spmod_list</code></p>


<p>objects, and the aforementioned <code>spmod</code> generics can be used on each
individual list element (model fit).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The spatial linear model for point-referenced data
(i.e., geostatistical model) can be written as
\(y = X \beta + \tau + \epsilon\), where X is the fixed effects design
matrix, \(\beta\) are the fixed effects, \(\tau\) is random error that is
spatially dependent, and \(\epsilon\) is random error that is spatially
independent. Together, \(\tau\) and \(\epsilon\) are modeled using
a spatial covariance function, expressed as
\(de * R + ie * I\), where \(de\) is the dependent error variance, \(R\)
is a correlation matrix that controls the spatial dependence structure among observations,
\(ie\) is the independent error variance, and \(I\) is
an identity matrix.</p>
<p><code>spcov_type</code> Details: Parametric forms for \(R\) are given below, where \(\eta = h / range\)
for \(h\) distance between observations:</p><ul><li><p>exponential: \(exp(- \eta )\)</p></li>
<li><p>spherical: \((1 - 1.5\eta + 0.5\eta^3) * I(h &lt;= range)\)</p></li>
<li><p>gaussian: \(exp(- \eta^2 )\)</p></li>
<li><p>triangular: \((1 - \eta) * I(h &lt;= range)\)</p></li>
<li><p>circular: \((1 - (2 / \pi) * (m * sqrt(1 - m^2) + sin^{-1}(m))) * I(h &lt;= range), m = min(\eta, 1)\)</p></li>
<li><p>cubic: \((1 - 7\eta^2 + 8.75\eta^3 - 3.5\eta^5 + 0.75\eta^7) * I(h &lt;= range)\)</p></li>
<li><p>pentaspherical: \((1 - 1.875\eta + 1.25\eta^3 - 0.375\eta^5) * I(h &lt;= range)\)</p></li>
<li><p>cosine: \(cos(\eta)\)</p></li>
<li><p>wave: \(sin(\eta) / \eta * I(h &gt; 0) + I(h = 0)\)</p></li>
<li><p>jbessel: \(Bj(h * range)\), Bj is Bessel-J function</p></li>
<li><p>gravity: \((1 + \eta^2)^{-0.5}\)</p></li>
<li><p>rquad: \((1 + \eta^2)^{-1}\)</p></li>
<li><p>magnetic: \((1 + \eta^2)^{-1.5}\)</p></li>
<li><p>matern: \(2^{1 - extra}/ \Gamma(extra) * \alpha^{extra} * Bk(\alpha, extra)\), \(\alpha = (2extra * \eta)^{0.5}\), Bk is Bessel-K function with order \(1/5 \le extra \le 5\)</p></li>
<li><p>cauchy: \((1 + \eta^2)^{-extra}\), \(extra &gt; 0\)</p></li>
<li><p>pexponential: \(exp(h^{extra/range)}\), \(0 &lt; extra \le 2\)</p></li>
<li><p>none: \(0\)</p></li>
</ul><p>All spatial covariance functions are valid in one spatial dimension. All
spatial covariance functions except <code>triangular</code> and <code>cosine</code> are
valid in two dimensions.</p>
<p><code>estmethod</code> Details: The various estimation methods are</p><ul><li><p><code>reml</code>: Maximize the restricted log-likelihood.</p></li>
<li><p><code>ml</code>: Maximize the log-likelihood.</p></li>
<li><p><code>sv-wls</code>: Minimize the semivariogram weighted least squares loss.</p></li>
<li><p><code>sv-cl</code>: Minimize the semivariogram composite likelihood loss.</p></li>
</ul><p><code>anisotropy</code> Details: By default, all spatial covariance parameters except <code>rotate</code>
and <code>scale</code> as well as all random effect variance parameters
are assumed unknown, requiring estimation. If either <code>rotate</code> or <code>scale</code>
are given initial values other than 0 and 1 (respectively) or are assumed unknown
in <code><a href="spcov_initial.html">spcov_initial()</a></code>, <code>anisotropy</code> is implicitly set to <code>TRUE</code>.
(Geometric) Anisotropy is modeled by transforming a covariance function that
decays differently in different directions to one that decays equally in all
directions via rotation and scaling of the original coordinates. The rotation is
controlled by the <code>rotate</code> parameter in \([0, \pi]\) radians. The scaling
is controlled by the <code>scale</code> parameter in \([0, 1]\). The anisotropy
correction involves first a rotation of the coordinates clockwise by <code>rotate</code> and then a
scaling of the coordinates' minor axis by the reciprocal of <code>scale</code>. The spatial
covariance is then computed using these transformed coordinates.</p>
<p><code>random</code> Details: If random effects are used (the estimation method must be <code>"reml"</code> or
<code>"ml"</code>), the model
can be written as \(y = X \beta + Z1u1 + ... Zjuj + \tau + \epsilon\),
where each Z is a random effects design matrix and each u is a random effect.</p>
<p><code>partition_factor</code> Details: The partition factor can be represented in matrix form as \(P\), where
elements of \(P\) equal one for observations in the same level of the partition
factor and zero otherwise. The covariance matrix involving only the
spatial and random effects components is then multiplied element-wise
(Hadmard product) by \(P\), yielding the final covariance matrix.</p>
<p><code>local</code> Details: The big data approximation works by sorting observations into different levels
of an index variable. Observations in different levels of the index variable
are assumed to be uncorrelated for the purposes of model fitting. Sparse matrix methods are then implemented
for significant computational gains. Parallelization further speeds up
computations. Both the <code>"random"</code> and <code>"kmeans"</code> values of <code>method</code>
in <code>local</code> have random components. That means you may get slightly different
results when using the big data approximation and rerunning <code>splm()</code> with the same code. For consistent results,
either set a seed via <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">base::set.seed()</a></code> or specify <code>index</code> to <code>local</code>.</p>
<p>Observations with <code>NA</code> response values are removed for model
fitting, but their values can be predicted afterwards by running
<code>predict(object)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function does not perform any internal scaling. If optimization is not
stable due to large extremely large variances, scale relevant variables
so they have variance 1 before optimization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spmod</span> <span class="op">&lt;-</span> <span class="fu">splm</span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">water</span> <span class="op">+</span> <span class="va">tarp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">caribou</span>,</span></span>
<span class="r-in"><span>  spcov_type <span class="op">=</span> <span class="st">"exponential"</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">spmod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splm(formula = z ~ water + tarp, data = caribou, spcov_type = "exponential", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xcoord = x, ycoord = y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.41281 -0.20763 -0.11205  0.02956  0.45429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients (fixed):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  2.04981    0.31093   6.592 4.33e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waterY      -0.08310    0.06449  -1.289 0.197563    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tarpnone     0.08005    0.07759   1.032 0.302166    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tarpshade    0.28654    0.07667   3.737 0.000186 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo R-squared: 0.3963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients (exponential spatial covariance):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      de      ie   range </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.1109  0.0226 19.1168 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

