<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spmodel">
<title>Spatial Generalized Linear Models in spmodel • spmodel</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Generalized Linear Models in spmodel">
<meta property="og:description" content="spmodel">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/guide.html">A Detailed Guide to spmodel</a>
    <a class="dropdown-item" href="../articles/SPGLMs.html">Spatial Generalized Linear Models in spmodel</a>
    <a class="dropdown-item" href="../articles/technical.html">Technical Details</a>
    <a class="dropdown-item" href="../articles/introduction.html">An Introduction to spmodel</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/spmodel/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Spatial Generalized Linear Models in spmodel</h1>
                        <h4 data-toc-skip class="author">Michael
Dumelle, Matt Higham, and Jay M. Ver Hoef</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/vignettes/articles/SPGLMs.Rmd" class="external-link"><code>vignettes/articles/SPGLMs.Rmd</code></a></small>
      <div class="d-none name"><code>SPGLMs.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="sec:introduction">Introduction<a class="anchor" aria-label="anchor" href="#sec:introduction"></a>
</h2>
<p><code>spmodel</code> is an package used to fit, summarize, and
predict for a variety of spatial statistical models. The vignette
provides an introduction spatial generalized linear models for
non-Gaussian response distributions in <code>spmodel</code>. Before
proceeding, we load <code>spmodel</code> by running</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usepa.github.io/spmodel/" class="external-link">spmodel</a></span><span class="op">)</span></span></code></pre></div>
<p>If using <code>spmodel</code> in a formal publication or report,
please cite it. Citing <code>spmodel</code> lets us devote more
resources to the package in the future. We view the <code>spmodel</code>
citation by running</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"spmodel"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To cite spmodel in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Dumelle M, Higham M, Ver Hoef JM (2023). spmodel: Spatial statistical</span></span>
<span><span class="co">#&gt;   modeling and prediction in R. PLOS ONE 18(3): e0282524.</span></span>
<span><span class="co">#&gt;   https://doi.org/10.1371/journal.pone.0282524</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   @Article{,</span></span>
<span><span class="co">#&gt;     title = {{spmodel}: Spatial statistical modeling and prediction in {R}},</span></span>
<span><span class="co">#&gt;     author = {Michael Dumelle and Matt Higham and Jay M. {Ver Hoef}},</span></span>
<span><span class="co">#&gt;     journal = {PLOS ONE},</span></span>
<span><span class="co">#&gt;     year = {2023},</span></span>
<span><span class="co">#&gt;     volume = {18},</span></span>
<span><span class="co">#&gt;     number = {3},</span></span>
<span><span class="co">#&gt;     pages = {1--32},</span></span>
<span><span class="co">#&gt;     doi = {10.1371/journal.pone.0282524},</span></span>
<span><span class="co">#&gt;     url = {https://doi.org/10.1371/journal.pone.0282524},</span></span>
<span><span class="co">#&gt;   }</span></span></code></pre>
<p>We will create visualizations using <code>ggplot2</code> <span class="citation">(Wickham 2016)</span>, which we load by running</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p><code>ggplot2</code> is only installed alongside <code>spmodel</code>
when <code>dependencies = TRUE</code> in
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>, so check that the package is installed
and loaded before reproducing any of these vignette’s visualizations. We
will also show code that can be used to create interactive
visualizations of spatial data with <code>mapview</code> <span class="citation">(Appelhans et al. 2022)</span>. <code>mapview</code>
also has many backgrounds available that contextualize spatial data with
topographical information. Before running the <code>mapview</code> code
interactively, make sure <code>mapview</code> is installed and
loaded.</p>
<p><code>spmodel</code> contains various methods for generic functions
defined outside of <code>spmodel</code>. To find relevant documentation
for these methods, run <code>help("generic.spmodel", "spmodel")</code>
(e.g., <code><a href="../reference/summary.spmodel.html">help("summary.spmodel", "spmodel")</a></code>,
<code><a href="../reference/predict.spmodel.html">help("predict.spmodel", "spmodel")</a></code>, etc.). Note that
<code>?generic.spmodel</code> is shorthand for
<code>help("generic.spmodel", "spmodel")</code>. We provide more details
and examples regarding these methods and generics throughout this
vignette. For a full list of <code>spmodel</code> functions available,
see <code>spmodel</code>’s documentation manual.</p>
</div>
<div class="section level2">
<h2 id="a-review-of-the-spatial-linear-model">A Review of the Spatial Linear Model<a class="anchor" aria-label="anchor" href="#a-review-of-the-spatial-linear-model"></a>
</h2>
<p>We first focus on spatial linear models for a Gaussian response
vector. The spatial linear model is defined as <span class="math display">\[\begin{equation}\label{eq:splm}
\mathbf{y} = \mathbf{X} \boldsymbol{\beta} + \boldsymbol{\tau} +
\boldsymbol{\epsilon},
\end{equation}\]</span> where for a sample size <span class="math inline">\(n\)</span>, <span class="math inline">\(\mathbf{y}\)</span> is an <span class="math inline">\(n \times 1\)</span> column vector of response
variables, <span class="math inline">\(\mathbf{X}\)</span> is an <span class="math inline">\(n \times p\)</span> design (model) matrix of
explanatory variables, <span class="math inline">\(\boldsymbol{\beta}\)</span> is a <span class="math inline">\(p \times 1\)</span> column vector of fixed effects
controlling the impact of <span class="math inline">\(\mathbf{X}\)</span> on <span class="math inline">\(\mathbf{y}\)</span>, <span class="math inline">\(\boldsymbol{\tau}\)</span> is an <span class="math inline">\(n \times 1\)</span> column vector of spatially
dependent random errors, and <span class="math inline">\(\boldsymbol{\epsilon}\)</span> is an <span class="math inline">\(n \times 1\)</span> column vector of spatially
independent random errors. We make a few assumptions about <span class="math inline">\(\boldsymbol{\tau}\)</span> and <span class="math inline">\(\boldsymbol{\epsilon}\)</span> in the spatial
linear model: first, that <span class="math inline">\(\text{E}(\boldsymbol{\tau}) =
\text{E}(\boldsymbol{\epsilon}) = \boldsymbol{0}\)</span>, where <span class="math inline">\(\text{E}(\cdot)\)</span> denotes expectation;
second, that <span class="math inline">\(\text{Cov}(\boldsymbol{\tau}) =
\sigma^2_\tau \mathbf{R}\)</span>, where <span class="math inline">\(\mathbf{R}\)</span> is an <span class="math inline">\(n \times n\)</span> matrix that determines the
spatial dependence structure in <span class="math inline">\(\mathbf{y}\)</span> and depends on a range
parameter, <span class="math inline">\(\phi\)</span>; third, that <span class="math inline">\(\text{Cov}(\boldsymbol{\epsilon}) =
\sigma^2_\epsilon \mathbf{I}\)</span>, where <span class="math inline">\(\mathbf{I}\)</span> is an <span class="math inline">\(n \times n\)</span> identity matrix; and fourth,
that <span class="math inline">\(\boldsymbol{\tau}\)</span> and <span class="math inline">\(\boldsymbol{\epsilon}\)</span> are independent of
one another. The parameter <span class="math inline">\(\sigma^2_{\tau}\)</span> is called the spatially
dependent random error variance or partial sill. The parameter <span class="math inline">\(\sigma^2_\epsilon\)</span> is called the spatially
independent random error variance or nugget. These two variance
parameters are henceforth more intuitively written as <span class="math inline">\(\sigma^2_{de}\)</span> and <span class="math inline">\(\sigma^2_{ie}\)</span>, respectively. The
covariance of <span class="math inline">\(\mathbf{y}\)</span> is denoted
<span class="math inline">\(\boldsymbol{\Sigma}\)</span> and given by
<span class="math display">\[\begin{equation}\label{eq:spcov}
\boldsymbol{\Sigma} = \sigma^2_{de}\mathbf{R} + \sigma^2_{ie}
\mathbf{I}.
\end{equation}\]</span> The parameters <span class="math inline">\(\sigma^2_{de}\)</span>, <span class="math inline">\(\phi\)</span>, and <span class="math inline">\(\sigma^2_{ie}\)</span> are elements of <span class="math inline">\(\boldsymbol{\theta}\)</span>, the covariance
parameter vector.</p>
<p>The spatial linear model applies to both point-referenced and areal
(i.e., lattice; polygon) data. Spatial data are point-referenced when
the elements in <span class="math inline">\(\mathbf{y}\)</span> are
observed at point-locations indexed by x-coordinates and y-coordinates
on a spatially continuous surface with an infinite number of locations.
For example, consider sampling soil at any point-location in a field.
Spatial linear models for point-referenced data are sometimes called
geostatistical models. An example of an <span class="math inline">\(\mathbf{R}\)</span> matrix for point-referenced
data is the spherical correlation matrix given by <span class="math display">\[\begin{equation}\label{eq:spherical}
\mathbf{R} = \left(1 - 1.5\frac{\mathbf{H}}{\phi} +
0.5\frac{\mathbf{H}^3}{\phi^3}\right) \odot \mathcal{I}(\mathbf{H} \leq
\phi),
\end{equation}\]</span><br>
where <span class="math inline">\(\mathbf{H}\)</span> is a matrix of
Euclidean distances among observations, <span class="math inline">\(\mathbf{H}^3\)</span> is a matrix of cubed
Euclidean distances, <span class="math inline">\(\odot\)</span> is the
Hadmard (element-wise; direct) product, and <span class="math inline">\(\mathcal{I}(\mathbf{H} \leq \phi)\)</span> is an
indicator function equal to one when the <span class="math inline">\(ij\)</span>th element of <span class="math inline">\(\mathbf{H}\)</span> is less than <span class="math inline">\(\phi\)</span> (the range) and zero otherwise. A
second is example is the Matérn correlation matrix given by <span class="math display">\[\begin{equation}\label{eq:matern}
\mathbf{R} = \frac{2^{1 - \nu}}{\Gamma(\nu)} \left(2\nu \mathbf{H} /
\phi \right)^{\nu / 2} \odot B_k(2\nu \mathbf{H}, \nu),
\end{equation}\]</span> where <span class="math inline">\(\nu\)</span>
is a smoothness parameter, <span class="math inline">\(\odot\)</span> is
the Hadmart (element-wise; direct) product, and <span class="math inline">\(B_k(\cdot, \nu)\)</span> is a Bessel-K function
with order <span class="math inline">\(\nu\)</span>. <span class="citation">Chiles and Delfiner (2012)</span> provide examples of
several spatial dependence structures.</p>
<p>Spatial data are areal when they are observed as part of a finite
network of polygons whose connections are indexed by a neighborhood
structure. For example, the polygons may represent counties in a state
who are neighbors if they share at least one boundary. An example of an
<span class="math inline">\(\mathbf{R}\)</span> matrix for areal data is
the simultaneous-autoregressive spatial correlation matrix given by
<span class="math display">\[\begin{equation*}
  \mathbf{R} = [(\mathbf{I} - \phi \mathbf{W})(\mathbf{I} - \phi
\mathbf{W})^\top]^{-1},
\end{equation*}\]</span> where <span class="math inline">\(\mathbf{W}\)</span> is a weight matrix that
describes the neighborhood structure among observations. Spatial linear
models for areal data are sometimes called spatial autoregressive
models. For thorough reviews of the spatial linear model, see <span class="citation">Cressie (1993)</span>, <span class="citation">Banerjee,
Carlin, and Gelfand (2014)</span>, and <span class="citation">Schabenberger and Gotway (2017)</span>.</p>
</div>
<div class="section level2">
<h2 id="the-spatial-generalized-linear-model">The Spatial Generalized Linear Model<a class="anchor" aria-label="anchor" href="#the-spatial-generalized-linear-model"></a>
</h2>
<p>It is common to implicitly assume <span class="math inline">\(\mathbf{y}\)</span> in the spatial linear model is
unconstrained and Gaussian. This is a restrictive assumption and often
inappropriate for binary data, proportion data, count data, and skewed
data, which are common in many practical applications. These types of
data are most naturally described using generalized linear models <span class="citation">(Nelder and Wedderburn 1972; McCullagh and Nelder
1989)</span>. Generalized linear models are an extension of linear
models that “link” a function of a distribution’s mean to the linear
function <span class="math inline">\(\mathbf{X}
\boldsymbol{\beta}\)</span> (the explanatory variables and fixed
effects). We can extend generalized linear models by adding linear,
latent (i.e., unobserved) random effects to <span class="math inline">\(\mathbf{X} \boldsymbol{\beta}\)</span>. These
types of models are called generalized linear mixed models <span class="citation">(Breslow and Clayton 1993)</span> and are often
formulated using a hierarchical construction <span class="citation">(Lee
and Nelder 1996)</span>. For thorough reviews of generalized linear
models and generalized linear mixed models, see <span class="citation">Bolker et al. (2009)</span>, <span class="citation">Myers et al. (2012)</span>, <span class="citation">Faraway (2016)</span>, and <span class="citation">Wood
(2017)</span>.</p>
<p>A recent <code>spmodel</code> release (version 0.4.0) provided
support for spatial generalized linear models (i.e., a generalized
linear mixed model with spatial random effects). We define the spatial
generalized linear model as <span class="math display">\[\begin{equation}\label{eq:spglm}
f(\boldsymbol{\mu}) \equiv \mathbf{w} = \mathbf{X} \boldsymbol{\beta} +
\boldsymbol{\tau} + \boldsymbol{\epsilon},
\end{equation}\]</span> where <span class="math inline">\(f(\cdot)\)</span> is the link function, <span class="math inline">\(\boldsymbol{\mu}\)</span> is the mean of <span class="math inline">\(\mathbf{y}\)</span>, and the remaining terms <span class="math inline">\(\mathbf{X}\)</span>, <span class="math inline">\(\boldsymbol{\beta}\)</span>, <span class="math inline">\(\boldsymbol{\tau}\)</span>, <span class="math inline">\(\boldsymbol{\epsilon}\)</span> represent the same
quantities as for spatial linear models. That is, <span class="math inline">\(\text{E}(\boldsymbol{\tau}) =
\text{E}(\boldsymbol{\epsilon}) = \boldsymbol{0}\)</span>, <span class="math inline">\(\text{Cov}(\boldsymbol{\tau}) =
\sigma^2_{de}\mathbf{R}\)</span>, <span class="math inline">\(\text{Cov}(\boldsymbol{\epsilon}) = \sigma^2_{ie}
\mathbf{I}\)</span>, <span class="math inline">\(\boldsymbol{\tau}\)</span> is independent of <span class="math inline">\(\boldsymbol{\epsilon}\)</span>, and <span class="math inline">\(\boldsymbol{\Sigma} = \sigma^2_{de} \mathbf{R} +
\sigma^2_{ie} \mathbf{I}\)</span>. The link function, <span class="math inline">\(f(\cdot)\)</span>, “links” a function of <span class="math inline">\(\boldsymbol{\mu}\)</span> to the linear term <span class="math inline">\(\mathbf{w}\)</span>. Note that the linking of
<span class="math inline">\(\boldsymbol{\mu}\)</span> to <span class="math inline">\(\mathbf{w}\)</span> applies element-wise to each
vector. Each link function <span class="math inline">\(f(\cdot)\)</span>
has a corresponding inverse link function, <span class="math inline">\(f^{-1}(\cdot)\)</span>, which “links” a function
of <span class="math inline">\(\mathbf{w}\)</span> to <span class="math inline">\(\boldsymbol{\mu}\)</span>. Notice that <span class="math inline">\(\mathbf{w}\)</span> is unconstrained but <span class="math inline">\(\boldsymbol{\mu}\)</span> is usually constrained
in some way (e.g., positive) that depends on the distribution assumed
for <span class="math inline">\(\mathbf{y}\)</span>.</p>
<p>Spatial linear and generalized linear models rely on the same
components: explanatory variables, fixed effects, spatially dependent
random errors, and spatial independent random errors. These components
are related to the response linearly (spatial linear models) or
non-linearly (spatial generalized linear models). The response itself is
generally assumed to follow a Gaussian distribution (spatial linear
models) or one of many non-Gaussian distributions (spatial generalized
linear models). Some non-Gaussian distributions include the binomial
distribution for binary responses, the beta distribution for proportion
responses, the Poisson or negative binomial distributions for count
responses, and the gamma or inverse Gaussian distributions for skewed,
positive continuous responses.</p>
<p><code>spmodel</code> implements a marginal approach to inference that
uses a novel application of the Laplace approximation. This marginal
approach is powerful and flexible, accommodating a wide range of
covariance structures. It is a frequentist approach, which means that it
does not rely on any Bayesian sampling routines, as is common when
handling complex hierarchical structures. It also formally maximizes a
likelihood, which is advantageous because it means that likelihood-based
statistics such as AIC <span class="citation">(Akaike 1974; Hoeting et
al. 2006)</span> are defined, in contrast to approaches that only
specify the first two moments of a distribution (e.g., quasi-likelihood
fit via iteratively re-weighted least squares). <span class="citation">Ver Hoef et al. (2023)</span> provide the methodology’s
full details.</p>
<p><code>spmodel</code> accommodates the binomial, beta, Poisson,
negative binomial, gamma, and inverse Gaussian distributions. The
binomial and beta response distributions (specified by ) use the logit
link, while the Poisson, negative binomial, gamma, and inverse Gaussian
distributions use the log link – see the following table.</p>
<table class="table">
<caption>Spatial generalized linear model response distributions
available in spmodel alongside their corresponding link functions and
data types.</caption>
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Family</th>
<th>Link Function</th>
<th>Link Name</th>
<th>Data Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Binomial</td>
<td><span class="math inline">\(f(\mathbf{\mu}) = \log(\mathbf{\mu} / (1
- \mathbf{\mu}))\)</span></td>
<td>Logit</td>
<td>Binary; Binary Count</td>
</tr>
<tr class="even">
<td>Poisson</td>
<td><span class="math inline">\(f(\mathbf{\mu}) =
\log(\mathbf{\mu})\)</span></td>
<td>Log</td>
<td>Count</td>
</tr>
<tr class="odd">
<td>Negative Binomial</td>
<td><span class="math inline">\(f(\mathbf{\mu}) =
\log(\mathbf{\mu})\)</span></td>
<td>Log</td>
<td>Count</td>
</tr>
<tr class="even">
<td>Beta</td>
<td><span class="math inline">\(f(\mathbf{\mu}) = \log(\mathbf{\mu} / (1
- \mathbf{\mu}))\)</span></td>
<td>Logit</td>
<td>Proportion</td>
</tr>
<tr class="odd">
<td>Gamma</td>
<td><span class="math inline">\(f(\mathbf{\mu}) =
\log(\mathbf{\mu})\)</span></td>
<td>Log</td>
<td>Skewed</td>
</tr>
<tr class="even">
<td>Inverse Gaussian</td>
<td><span class="math inline">\(f(\mathbf{\mu}) =
\log(\mathbf{\mu})\)</span></td>
<td>Log</td>
<td>Skewed</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="sec:model-fit">Model fitting<a class="anchor" aria-label="anchor" href="#sec:model-fit"></a>
</h3>
<p>Spatial generalized linear models in <code>spmodel</code> are fit
using (for point-referenced data) or (for areal data). These functions
are similar in structure both to one another and to the function in base
<strong>R</strong>. They generally require the following four arguments:
, a formula that describes the relationship between the response and
explanatory variables; , the response distribution, which can be , , , ,
, or ; , a or object <span class="citation">(Pebesma 2018)</span> whose
rows index observations and whose columns contain the response variable,
explanatory variables, and spatial information; and , one of 19 spatial
covariance types (e.g., spherical spatial covariance, Matérn spatial
covariance, simultaneous-autoregressive spatial covariance etc.). The
binomial and beta response distributions (specified by ) use the logit
link, while the Poisson, negative binomial, gamma, and inverse Gaussian
distributions use the log link. Other arguments to and are either
required only in specific situations or have default values specified.
All arguments to the and functions are summarized in the following
table. Models for several hundred observations can take anywhere from a
few seconds to a few minutes to fit, depending on the shape of the
likelihood surface and how quickly the covariance parameters converge.
Models for several thousand observations can utilize
<code>spmodel</code>’s large data set options.</p>
<table class="table">
<caption>Arguments to spglm() and spgautor(), their purpose, and whether
the argument applies to both spglm() and spgautor() or just one of
them.</caption>
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Purposes</th>
<th>Applies To</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\texttt{formula}\)</span></td>
<td>Fixed effects formula</td>
<td>Both</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{family}\)</span></td>
<td>Response distribution</td>
<td>Both</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{data}\)</span></td>
<td>Data Frame or object</td>
<td>Both</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{spcov_type}\)</span></td>
<td>Spatial covariance type</td>
<td>Both</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{spcov_initial}\)</span></td>
<td>Initial or known spatial covariance parameters</td>
<td>Both</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{dispersion_initial}\)</span></td>
<td>Initial or known dispersion parameter</td>
<td>Both</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{estmethod}\)</span></td>
<td>Estimation method</td>
<td>Both</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{random}\)</span></td>
<td>Random effects formula</td>
<td>Both</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{randcov_initial}\)</span></td>
<td>Initial or known random effect variances</td>
<td>Both</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{partition_factor}\)</span></td>
<td>A partition factor formula</td>
<td>Both</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{...}\)</span></td>
<td>Additional arguments</td>
<td>Both</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{anisotropy}\)</span></td>
<td>Whether to model anisotropy</td>
<td><span class="math inline">\(\texttt{spglm()}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{xcoord}\)</span></td>
<td>An x-coordinate name</td>
<td><span class="math inline">\(\texttt{spglm()}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{ycoord}\)</span></td>
<td>A y-coordinate name</td>
<td><span class="math inline">\(\texttt{spglm()}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{local}\)</span></td>
<td>Options for large data sets</td>
<td><span class="math inline">\(\texttt{spglm()}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{W}\)</span></td>
<td>A neighborhood weight matrix</td>
<td><span class="math inline">\(\texttt{spgautor()}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{row_st}\)</span></td>
<td>Whether to row-standardize <span class="math inline">\(\texttt{W}\)</span>
</td>
<td><span class="math inline">\(\texttt{spgautor()}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{M}\)</span></td>
<td>A symmetry matrix</td>
<td><span class="math inline">\(\texttt{spgautor()}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="sec:diagnostics">Model evaluation and diagnostics<a class="anchor" aria-label="anchor" href="#sec:diagnostics"></a>
</h3>
<p>After fitting a model, it is usually beneficial to evaluate certain
aspects of model fit or inspect and visualize model diagnostics like
residuals. There are many functions in <code>spmodel</code> that are
used for these purposes, and their main argument is the fitted model
object returned by or . The names of these functions are meant to be
illustrative, describing the purpose of the function itself. The
functions for evaluating model fit (see below) return likelihood-based
statistics like AIC, AICc, and deviance <span class="citation">(McCullagh and Nelder 1989)</span>, return coefficient
estimates and confidence intervals, perform cross validation, and
more.</p>
<table class="table">
<caption>Model evaluation functions available for models fit using
spglm() or spgautor() and their purpose.</caption>
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<span class="math inline">\(\texttt{AIC()}\)</span>; <span class="math inline">\(\texttt{AICc()}\)</span>
</td>
<td>Return AIC and AICc</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{anova()}\)</span></td>
<td>Perform an analysis of variance</td>
</tr>
<tr class="odd">
<td>
<span class="math inline">\(\texttt{coef()}\)</span>; <span class="math inline">\(\texttt{coefficients()}\)</span>
</td>
<td>Return parameter estimates</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{confint()}\)</span></td>
<td>Return confidence intervals</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{covmatrix()}\)</span></td>
<td>Return the fitted covariance matrix</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{deviance()}\)</span></td>
<td>Return the deviance</td>
</tr>
<tr class="odd">
<td>
<span class="math inline">\(\texttt{glance()}\)</span>; <span class="math inline">\(\texttt{glances()}\)</span>
</td>
<td>Glance at model fits</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{logLik()}\)</span></td>
<td>Return the log-likelihood</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{loocv()}\)</span></td>
<td>Perform leave-one-out cross validation</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{pseudoR2()}\)</span></td>
<td>Return the pseudo R-squared</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{summary()}\)</span></td>
<td>Summarize the fitted model</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{tidy()}\)</span></td>
<td>Tidy the fitted model</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{varcomp()}\)</span></td>
<td>Compare sources of variability</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{vcov()}\)</span></td>
<td>Return variance-covariance matrices</td>
</tr>
</tbody>
</table>
<p>The functions for inspecting model diagnostics (see below) return
Cook’s distances <span class="citation">(Cook 1979)</span>, fitted
values, leverage (hat) values, residuals (of several types), and
visualizations.</p>
<table class="table">
<caption>Mode diagnostic functions available for models fit using
spglm() or spgautor() and their purpose.</caption>
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\texttt{augment()}\)</span></td>
<td>Augment model data with diagnostics</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{cooks.distance()}\)</span></td>
<td>Return Cook’s distances</td>
</tr>
<tr class="odd">
<td>
<span class="math inline">\(\texttt{fitted()}\)</span>; <span class="math inline">\(\texttt{fitted.values()}\)</span>
</td>
<td>Return fitted values</td>
</tr>
<tr class="even">
<td>
<span class="math inline">\(\texttt{hatvalues()}\)</span>;</td>
<td>Return hat (leverage) values</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{plot()}\)</span></td>
<td>Plot model diagnostics</td>
</tr>
<tr class="even">
<td>
<span class="math inline">\(\texttt{residuals()}\)</span>; <span class="math inline">\(\texttt{resid()}\)</span>; <span class="math inline">\(\texttt{rstandard()}\)</span>
</td>
<td>Return residuals</td>
</tr>
</tbody>
</table>
<p>The functions , , and , popularized by the <code>broom</code>
<strong>R</strong> package <span class="citation">(Robinson, Hayes, and
Couch 2021)</span>, are particularly useful. The function tidies
parameter estimate output, returning a special called a <span class="citation">(Müller and Wickham 2021)</span> that is much easier to
manipulate and work with than the parameter estimate output printed by
to the <strong>R</strong> console. The function glances at the model
fit, returning a with the sample size, number of estimated parameters,
and several model-fit statistics. is an extension of that glances at
multiple models simultaneously. The function augments the model fit,
returning a with the data used to fit the model as well as model
diagnostics. The function can also be used to augment prediction data,
as we discuss next.</p>
</div>
<div class="section level3">
<h3 id="sec:prediction">Prediction<a class="anchor" aria-label="anchor" href="#sec:prediction"></a>
</h3>
<p>Often a priority of a spatial data analysis is using the fitted model
to make predictions at unobserved locations and quantify uncertainties
in those predictions. The function in <code>spmodel</code> is used to
predict the mean process at unobserved locations. It is similar in
structure to for objects fit using in base <strong>R</strong> and takes
two main arguments: , the fitted model object returned by or ; and , a
or object whose rows index locations requiring prediction and whose
columns contain the explanatory variables and spatial information at
these locations. Other arguments to are either required only in specific
situations or have default values specified. All arguments to the
function are summarized in the following table. The function can also be
used to augment with predictions, taking the same arguments as .</p>
<table class="table">
<caption>Arguments to predict() and their purpose.</caption>
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\texttt{object}\)</span></td>
<td>Fitted model object</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{newdata}\)</span></td>
<td>New data frame or object</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{type}\)</span></td>
<td>Whether predictions are on the link or response scale</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{se.fit}\)</span></td>
<td>Whether standard errors should be returned</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{interval}\)</span></td>
<td>Interval type (prediction or confidence)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{level}\)</span></td>
<td>Prediction or confidence level</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{local}\)</span></td>
<td>Options for large data sets</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{var_correct}\)</span></td>
<td>Whether prediction variances should be adjusted</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{...}\)</span></td>
<td>Additional arguments</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="sec:simulation">Simulation<a class="anchor" aria-label="anchor" href="#sec:simulation"></a>
</h3>
<p><code>spmodel</code> has functions that are used to simulate spatial
data from Gaussian, binomial, beta, Poisson, negative binomial, gamma,
and inverse Gaussian response distributions. These simulation functions
are similar in structure to commonly used base <strong>R</strong>
functions for simulating data. They are also similar in name, simply
adding an prefix to the conventional name in base <strong>R</strong>.
For example, is used to simulate Poisson data in base
<strong>R</strong>, while is used to simulate spatial Poisson data in
<code>spmodel</code>. These functions are summarized in the following
table.</p>
<table class="table">
<caption>Functions to simulate spatial data and their purpose.</caption>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\texttt{sprnorm()}\)</span></td>
<td>Simulate spatial Gaussian data</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{sprbinom()}\)</span></td>
<td>Simulate spatial binomial data</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{sprbeta()}\)</span></td>
<td>Simulate spatial beta data</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{sprpois()}\)</span></td>
<td>Simulate spatial Poisson data</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{sprnbinom()}\)</span></td>
<td>Simulate spatial negative binomial data</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\texttt{sprgamma()}\)</span></td>
<td>Simulate spatial gamma data</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\texttt{sprinvgauss()}\)</span></td>
<td>Simulate spatial inverse Gaussian data</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="sec:application-binary">An application to binary (presence/abscence) data<a class="anchor" aria-label="anchor" href="#sec:application-binary"></a>
</h2>
<p>In the next two sections we to show how to use <code>spmodel</code>
to analyze data collected on moose in the Togiak region of Alaska, USA.
The data in <code>spmodel</code> contain information on moose counts
from a survey of sites in the Togiak region. The data are stored as an
<code>sf</code> object, a special built to store spatial data. has
several variables: ; a stratification variable with two levels ( for low
and for medium) based on surrounding landscape metrics; , the site
elevation; , whether or not at least one moose was observed at the site;
, the number of moose observed at a the site; and , the spatial
coordinates in an Alaska Albers projection (EPSG: 3338). We load
<code>spmodel</code> and the data by running</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://usepa.github.io/spmodel/" class="external-link">"spmodel"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"moose"</span><span class="op">)</span></span></code></pre></div>
<p>We are interested in quantifying the effects of and on moose and
begin with some visualizations. First, we visualize the presence for
observed sites:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">moose</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">presence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SPGLMs_files/figure-html/moosepres-1.png" alt="Moose presence." width="65%"><p class="caption">
Moose presence.
</p>
</div>
<p>There is spatial patterning in the distribution of moose presence, as
moose tend to be present in the eastern and southwestern parts of the
domain. This spatial pattern seems to have a directional orientation,
seemingly strongest in the northwest-to-southeast direction.</p>
<p>Next, we visualize the elevation for each strata:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">moose</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">elev</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">strat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">62.6</span>, <span class="fl">63.6</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">148.5</span>, <span class="op">-</span><span class="fl">146</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="SPGLMs_files/figure-html/moosestrat-1.png" alt="Elevation versus strata in the moose data." width="100%"><p class="caption">
Elevation versus strata in the moose data.
</p>
</div>
<p>There are no obvious spatial patterns in the assignment of sites to
strata, while elevation is highest on the boundaries of the domain and
lowest in the middle of the domain. There is spatial patterning in the
distribution of moose presence, as moose tend to be present in the
eastern and southwestern parts of the domain. This spatial pattern seems
to have a directional orientation, seemingly strongest in the
northwest-to-southeast direction.</p>
<p>To quantify the effects of , , and spatial dependence on moose
presence, we fit three binomial (i.e., ) logistic regression models
using :</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model one</span></span>
<span><span class="va">bin_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spglm.html">spglm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">presence</span> <span class="op">~</span> <span class="va">elev</span> <span class="op">+</span> <span class="va">strat</span> <span class="op">+</span> <span class="va">elev</span><span class="op">:</span><span class="va">strat</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">moose</span>,</span>
<span>  spcov_type <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># model two</span></span>
<span><span class="va">bin_spmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spglm.html">spglm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">presence</span> <span class="op">~</span> <span class="va">elev</span> <span class="op">+</span> <span class="va">strat</span> <span class="op">+</span> <span class="va">elev</span><span class="op">:</span><span class="va">strat</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">moose</span>,</span>
<span>  spcov_type <span class="op">=</span> <span class="st">"spherical"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># model three</span></span>
<span><span class="va">bin_spmod_anis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spglm.html">spglm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">presence</span> <span class="op">~</span> <span class="va">elev</span> <span class="op">+</span> <span class="va">strat</span> <span class="op">+</span> <span class="va">elev</span><span class="op">:</span><span class="va">strat</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">moose</span>,</span>
<span>  spcov_type <span class="op">=</span> <span class="st">"spherical"</span>,</span>
<span>  anisotropy <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>All three models have the same fixed effect structure, using
elevation, strata, and their interaction to explain moose presence. The
three models vary in their covariance structure. The first model, , has
no spatial covariance (<span class="math inline">\(\sigma^2_{de} =
0\)</span>). The second model, has a spherical spatial covariance. The
third model, , has a spherical spatial covariance that incorporates
geometric anisotropy. Geometric anisotropy allows the spatial covariance
to vary with direction by evaluating the spatial covariance with <span class="math inline">\(\mathbf{H}^*\)</span> (instead of <span class="math inline">\(\mathbf{H}\)</span>), a matrix of distances
between transformed coordinates that are rotated and scaled
appropriately <span class="citation">(Schabenberger and Gotway
2017)</span>. We evaluate the three models using AIC by running</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">bin_mod</span>, <span class="va">bin_spmod</span>, <span class="va">bin_spmod_anis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;                df      AIC</span></span>
<span><span class="co">#&gt; bin_mod         1 719.1628</span></span>
<span><span class="co">#&gt; bin_spmod       3 686.9031</span></span>
<span><span class="co">#&gt; bin_spmod_anis  5 677.9403</span></span></code></pre>
<p>The spatial models (, ) have a much lower AIC than the non-spatial
model (), which suggests that the models benefit from incorporating
spatial dependence. has a lower AIC than , which suggests that the model
benefits from incorporating directionality in the spatial dependence.
Next we inspect and later use it to predict moose presence probability
at unobserved sites.</p>
<p>We summarize using :</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bin_spmod_anis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; spglm(formula = presence ~ elev + strat + elev:strat, family = "binomial", </span></span>
<span><span class="co">#&gt;     data = moose, spcov_type = "spherical", anisotropy = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1.7970 -0.7348  0.3291  0.6855  1.7384 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (fixed):</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">#&gt; (Intercept) -3.112818   1.522362  -2.045  0.04088 * </span></span>
<span><span class="co">#&gt; elev         0.010990   0.004655   2.361  0.01824 * </span></span>
<span><span class="co">#&gt; stratM       3.820320   1.176127   3.248  0.00116 **</span></span>
<span><span class="co">#&gt; elev:stratM -0.014020   0.006933  -2.022  0.04316 * </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pseudo R-squared: 0.1119</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (spherical spatial covariance):</span></span>
<span><span class="co">#&gt;        de        ie     range    rotate     scale </span></span>
<span><span class="co">#&gt; 6.580e+00 2.220e-03 1.791e+05 2.718e+00 2.154e-01 </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "spherical"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (Dispersion for binomial family):</span></span>
<span><span class="co">#&gt; dispersion </span></span>
<span><span class="co">#&gt;          1</span></span></code></pre>
<p>The output from an model is very similar to the output from a
base-<strong>R</strong> model, returning the original function call,
deviance residuals, a fixed effects coefficients table, a pseudo
R-squared (which quantifies the amount of variability explained by the
fixed effects), and covariance parameter coefficients. The fixed effects
coefficients table provides some evidence that elevation and strata are
associated with with moose presence and that the effect of elevation
varies across the two strata (all <span class="math inline">\(p~\)</span>values <span class="math inline">\(&lt;\)</span> 0.05). The function returns graphics
of several model diagnostics. Running</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bin_spmod_anis</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="SPGLMs_files/figure-html/unnamed-chunk-9-1.png" alt="Spatial dependence is a function of distance (left) and as an anisotropic level curve of equal correlation (right)." width="50%"><img src="SPGLMs_files/figure-html/unnamed-chunk-9-2.png" alt="Spatial dependence is a function of distance (left) and as an anisotropic level curve of equal correlation (right)." width="50%"><p class="caption">
Spatial dependence is a function of distance (left) and as an
anisotropic level curve of equal correlation (right).
</p>
</div>
<p>shows that the spatial dependence is evident and appears strongest in
the northwest-to-southeast direction. These findings are supported by
the clear spatial patterns in the data.</p>
<p>Recall that the , , and functions are particularly useful tools for
manipulating and understanding fitted model objects. The function tidies
model output, returning a of parameter estimates (and confidence
intervals):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">bin_spmod_anis</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">#&gt;   term        estimate std.error statistic p.value conf.low conf.high</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> (Intercept)  -<span style="color: #BB0000;">3.11</span>     1.52        -<span style="color: #BB0000;">2.04</span> 0.040<span style="text-decoration: underline;">9</span>  -<span style="color: #BB0000;">6.10</span>    -<span style="color: #BB0000;">0.129</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> elev          0.011<span style="text-decoration: underline;">0</span>   0.004<span style="text-decoration: underline;">66</span>      2.36 0.018<span style="text-decoration: underline;">2</span>   0.001<span style="text-decoration: underline;">87</span>  0.020<span style="text-decoration: underline;">1</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> elev:stratM  -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">0</span>   0.006<span style="text-decoration: underline;">93</span>     -<span style="color: #BB0000;">2.02</span> 0.043<span style="text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.027</span><span style="color: #BB0000; text-decoration: underline;">6</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">431</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> stratM        3.82     1.18         3.25 0.001<span style="text-decoration: underline;">16</span>  1.52     6.13</span></span></code></pre>
<p>By default, the fixed effects estimates are returned, but covariance
parameter estimates are returned via the argument:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">bin_spmod_anis</span>, effects <span class="op">=</span> <span class="st">"spcov"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   term       estimate is_known</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> de          6.58    FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ie          0.002<span style="text-decoration: underline;">22</span> FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> range  <span style="text-decoration: underline;">179</span>082.      FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> rotate      2.72    FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> scale       0.215   FALSE</span></span></code></pre>
<p>The column indicates whether covariance parameters were assumed
known, which is possible to specify using the argument to . Here, all
parameters were assumed unknown and then estimated.</p>
<p>The function glances at model fit, returning a of model fit
statistics:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">bin_spmod_anis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;       n     p  npar value   AIC  AICc logLik deviance pseudo.r.squared</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   218     4     5  668.  678.  678.  -<span style="color: #BB0000;">334.</span>     161.            0.112</span></span></code></pre>
<p> can be used to glance at multiple models simultaneously and sorts
models by ascending AICc:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/glances.html">glances</a></span><span class="op">(</span><span class="va">bin_mod</span>, <span class="va">bin_spmod</span>, <span class="va">bin_spmod_anis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 10</span></span></span>
<span><span class="co">#&gt;   model         n     p  npar value   AIC  AICc logLik deviance pseudo.r.squared</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> bin_spmo…   218     4     5  668.  678.  678.  -<span style="color: #BB0000;">334.</span>     161.           0.112 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> bin_spmod   218     4     3  681.  687.  687.  -<span style="color: #BB0000;">340.</span>     161.           0.088<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> bin_mod     218     4     1  717.  719.  719.  -<span style="color: #BB0000;">359.</span>     294.           0.028<span style="text-decoration: underline;">3</span></span></span></code></pre>
<p>The function augments the data with model diagnostics:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aug_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">bin_spmod_anis</span><span class="op">)</span></span>
<span><span class="va">aug_mod</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 218 features and 8 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 269085 ymin: 1416151 xmax: 419057.4 ymax: 1541016</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / Alaska Albers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 218 × 9</span></span></span>
<span><span class="co">#&gt;    presence  elev strat .fitted .resid    .hat   .cooksd .std.resid</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0         469. L      0.130  -<span style="color: #BB0000;">0.527</span> 0.092<span style="text-decoration: underline;">3</span>  0.007<span style="text-decoration: underline;">77</span>       -<span style="color: #BB0000;">0.553</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0         362. L      0.027<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.235</span> 0.009<span style="text-decoration: underline;">73</span> 0.000<span style="text-decoration: underline;">137</span>      -<span style="color: #BB0000;">0.236</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 0         173. M      0.029<span style="text-decoration: underline;">7</span> -<span style="color: #BB0000;">0.246</span> 0.001<span style="text-decoration: underline;">36</span> 0.000<span style="text-decoration: underline;">020</span>5     -<span style="color: #BB0000;">0.246</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 0         280. L      0.012<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.155</span> 0.001<span style="text-decoration: underline;">87</span> 0.000<span style="text-decoration: underline;">011</span>3     -<span style="color: #BB0000;">0.155</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 0         620. L      0.276  -<span style="color: #BB0000;">0.804</span> 0.360   0.142         -<span style="color: #BB0000;">1.01</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 0         164. M      0.066<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.372</span> 0.002<span style="text-decoration: underline;">86</span> 0.000<span style="text-decoration: underline;">099</span>6     -<span style="color: #BB0000;">0.373</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 0         164. M      0.096<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.449</span> 0.003<span style="text-decoration: underline;">97</span> 0.000<span style="text-decoration: underline;">202</span>      -<span style="color: #BB0000;">0.450</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 0         186. L      0.075<span style="text-decoration: underline;">4</span> -<span style="color: #BB0000;">0.396</span> 0.004<span style="text-decoration: underline;">86</span> 0.000<span style="text-decoration: underline;">192</span>      -<span style="color: #BB0000;">0.397</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 0         362. L      0.061<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.355</span> 0.021<span style="text-decoration: underline;">1</span>  0.000<span style="text-decoration: underline;">692</span>      -<span style="color: #BB0000;">0.359</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 0         430. L      0.165  -<span style="color: #BB0000;">0.600</span> 0.087<span style="text-decoration: underline;">1</span>  0.009<span style="text-decoration: underline;">41</span>       -<span style="color: #BB0000;">0.628</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 208 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: geometry &lt;POINT [m]&gt;</span></span></span></code></pre>
<p>where are fitted values (the estimated <span class="math inline">\(f^{-1}(\mathbf{w})\)</span>, or moose presence
probability), are response residuals, values indicate leverage, values
indicate Cook’s distance (i.e., influence), and are standardized
residuals.</p>
<p>The data contains survey sites that were not sampled. We can use to
make predictions of the underlying probabilities of moose presence at
these sites using or . and return the same predictions but augments the
prediction data with the predictions:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"moose_preds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spmod_anis_preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">bin_spmod_anis</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">moose_preds</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"prediction"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spmod_anis_preds</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;          fit         lwr       upr</span></span>
<span><span class="co">#&gt; 1 0.53625613 0.150268897 0.8831963</span></span>
<span><span class="co">#&gt; 2 0.45236331 0.106721924 0.8509940</span></span>
<span><span class="co">#&gt; 3 0.09535359 0.010375867 0.5144805</span></span>
<span><span class="co">#&gt; 4 0.10772261 0.022873507 0.3837176</span></span>
<span><span class="co">#&gt; 5 0.83772891 0.466479245 0.9682358</span></span>
<span><span class="co">#&gt; 6 0.03276524 0.003867679 0.2281264</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aug_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span></span>
<span>  <span class="va">bin_spmod_anis</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">moose_preds</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"response"</span>, </span>
<span>  interval <span class="op">=</span> <span class="st">"prediction"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">aug_pred</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 100 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 269386.2 ymin: 1418453 xmax: 419976.2 ymax: 1541763</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / Alaska Albers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 6</span></span></span>
<span><span class="co">#&gt;     elev strat .fitted  .lower .upper           geometry</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  143. L      0.536  0.150    0.883 (401239.6 1436192)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  324. L      0.452  0.107    0.851 (352640.6 1490695)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  158. L      0.095<span style="text-decoration: underline;">4</span> 0.010<span style="text-decoration: underline;">4</span>   0.514 (360954.9 1491590)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  221. M      0.108  0.022<span style="text-decoration: underline;">9</span>   0.384 (291839.8 1466091)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  209. M      0.838  0.466    0.968 (310991.9 1441630)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  218. L      0.032<span style="text-decoration: underline;">8</span> 0.003<span style="text-decoration: underline;">87</span>  0.228 (304473.8 1512103)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  127. L      0.038<span style="text-decoration: underline;">1</span> 0.005<span style="text-decoration: underline;">11</span>  0.234 (339011.1 1459318)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  122. L      0.074<span style="text-decoration: underline;">7</span> 0.009<span style="text-decoration: underline;">83</span>  0.396 (342827.3 1463452)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  191  L      0.375  0.041<span style="text-decoration: underline;">0</span>   0.893 (284453.8 1502837)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  105. L      0.142  0.019<span style="text-decoration: underline;">7</span>   0.577 (391343.9 1483791)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre>
<p>Estimated moose presence probability for the data (obtained via ) and
predicted moose presence probability for the data (obtained via or ) are
overlain below and share similar patterns:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aug_mod</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"mod"</span></span>
<span><span class="va">aug_pred</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"pred"</span></span>
<span><span class="va">keep_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".fitted"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span><span class="va">aug_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">aug_mod</span><span class="op">[</span>, <span class="va">keep_cols</span><span class="op">]</span>, <span class="va">aug_pred</span><span class="op">[</span>, <span class="va">keep_cols</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">aug_combined</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">.fitted</span>, shape <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SPGLMs_files/figure-html/bin-1.png" alt="Fitted values and predictions for moose presence probability." width="65%"><p class="caption">
Fitted values and predictions for moose presence probability.
</p>
</div>
</div>
<div class="section level2">
<h2 id="sec:application-count">An application to count data<a class="anchor" aria-label="anchor" href="#sec:application-count"></a>
</h2>
<p>The data also contain the number of moose observed at each site:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">moose</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SPGLMs_files/figure-html/moose-1.png" alt="Moose counts." width="65%"><p class="caption">
Moose counts.
</p>
</div>
<p>The moose counts are similarly distributed as moose presence, highest
in the eastern and southwestern parts of the domain. We compare two
count models, Poisson and negative binomial. The Poisson model assumes
the underlying process generating the counts has the same mean and
variance while the negative binomial model allows for overdispersion
(i.e., the variance is greater than the mean). We are interested in
quantifying the effects of and on moose <code>count</code>, albeit using
a slightly different approach than we did for moose
<code>presence</code>. Here, we will model elevation as a fixed effect
and allow this effect to change between strata, but we will model strata
as a random effect to highlight additional flexibility of the
<code>spmodel</code> package. We fit relevant Poisson and negative
binomial models with a Matérn spatial covariance using :</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_mod_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spglm.html">spglm</a></span><span class="op">(</span></span>
<span>  <span class="va">count</span> <span class="op">~</span> <span class="va">elev</span> <span class="op">+</span> <span class="va">elev</span><span class="op">:</span><span class="va">strat</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">moose</span>,</span>
<span>  spcov_type <span class="op">=</span> <span class="st">"matern"</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">strat</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">count_mod_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spglm.html">spglm</a></span><span class="op">(</span></span>
<span>  <span class="va">count</span> <span class="op">~</span> <span class="va">elev</span> <span class="op">+</span> <span class="va">elev</span><span class="op">:</span><span class="va">strat</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"nbinomial"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">moose</span>,</span>
<span>  spcov_type <span class="op">=</span> <span class="st">"matern"</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">strat</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Random effects are specified in <code>spmodel</code> via the argument
using similar syntax as the commonly used <code>lme4</code> <span class="citation">(Bates et al. 2015)</span> and <code>nlme</code> <span class="citation">(Pinheiro and Bates 2006)</span> <strong>R</strong>
packages for non-spatial mixed models. In <code>spmodel</code>, is
short-hand for . Random effects alter the covariance structure of the
model, building additional correlation into the model for sites sharing
a level of the random effect (here, sites within the same strata). More
formally, when incorporating a random effect, the spatial generalized
linear model becomes <span class="math display">\[\begin{equation}\label{eq:spglm-rand}
f(\boldsymbol{\mu}) \equiv \mathbf{w} = \mathbf{X} \boldsymbol{\beta} +
\mathbf{Z}\mathbf{v} + \boldsymbol{\tau} + \boldsymbol{\epsilon},
\end{equation}\]</span> where <span class="math inline">\(\mathbf{Z}\)</span> is a design matrix that
indexes the random effects, <span class="math inline">\(\mathbf{v}\)</span>, and <span class="math inline">\(\text{Cov}(\mathbf{v}) =
\sigma^2_{v}\mathbf{I}\)</span>. Then the covariance matrix, <span class="math inline">\(\boldsymbol{\Sigma}\)</span>, becomes <span class="math inline">\(\sigma^2_v \mathbf{Z} \mathbf{Z}^\top +
\sigma^2_{de}\mathbf{R} + \sigma^2_{ie}\mathbf{I}\)</span>.</p>
<p>Previously we compared models using , but another way to compare
models is by leave-one-out cross validation <span class="citation">(Hastie et al. 2009)</span>. In leave-one-out cross
validation, each observation is held-out and the model is re-fit and
used to predict the held-out observation. Then a loss statistic is
computed that compares each prediction to its true value. We calculate
mean-squared-prediction error (MSPE) using leave-one-out cross
validation for both the Poisson and negative binomial model by
running</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/loocv.html">loocv</a></span><span class="op">(</span><span class="va">count_mod_pois</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;    bias  MSPE RMSPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  1.37  32.0  5.66</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/loocv.html">loocv</a></span><span class="op">(</span><span class="va">count_mod_nb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;    bias  MSPE RMSPE</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.291  27.1  5.20</span></span></code></pre>
<p>The negative binomial model has a lower MSPE, which suggests that
incorporating overdispersion improves model fit here. Tidying this
fitted model we see that there is some evidence elevation is related to
moose counts and that this effect changes across strata (all <span class="math inline">\(p~\)</span>values <span class="math inline">\(&lt;
0.1\)</span>):</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">count_mod_nb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   term        estimate std.error statistic p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> (Intercept) -<span style="color: #BB0000;">0.301</span>     1.50       -<span style="color: #BB0000;">0.200</span>  0.841 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> elev         0.005<span style="text-decoration: underline;">90</span>   0.003<span style="text-decoration: underline;">00</span>     1.96   0.049<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> elev:stratM -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">17</span>   0.004<span style="text-decoration: underline;">08</span>    -<span style="color: #BB0000;">1.76</span>   0.078<span style="text-decoration: underline;">9</span></span></span></code></pre>
<p>The function in <code>spmodel</code> apportions model variability
into fixed and random components:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/varcomp.html">varcomp</a></span><span class="op">(</span><span class="va">count_mod_nb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   varcomp            proportion</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Covariates (PR-sq)    0.032<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> de                    0.498  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ie                    0.001<span style="text-decoration: underline;">74</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1 | strat             0.467</span></span></code></pre>
<p>Most model variability is explained by the spatially dependent random
error () and the random effect for strata (). Running</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">count_mod_nb</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="SPGLMs_files/figure-html/unnamed-chunk-21-1.png" alt="Model diagnostics." width="50%"><img src="SPGLMs_files/figure-html/unnamed-chunk-21-2.png" alt="Model diagnostics." width="50%"><p class="caption">
Model diagnostics.
</p>
</div>
<p>shows observations of high influence or leverage and that the
standardized residuals tend to be spread out around zero.</p>
<p>Estimated mean moose counts for the data (obtained via ) and
predicted mean moose counts for the data (obtained via or ) share
similiar patterns and are overlain by running</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aug_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">count_mod_nb</span><span class="op">)</span></span>
<span><span class="va">aug_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">count_mod_nb</span>, newdata <span class="op">=</span> <span class="va">moose_preds</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">aug_mod</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"mod"</span></span>
<span><span class="va">aug_pred</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"pred"</span></span>
<span><span class="va">keep_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".fitted"</span>, <span class="st">"type"</span><span class="op">)</span></span>
<span><span class="va">aug_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">aug_mod</span><span class="op">[</span>, <span class="va">keep_cols</span><span class="op">]</span>, <span class="va">aug_pred</span><span class="op">[</span>, <span class="va">keep_cols</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">aug_combined</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">.fitted</span>, shape <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SPGLMs_files/figure-html/nb-1.png" alt="Fitted values and predictions for moose counts." width="65%"><p class="caption">
Fitted values and predictions for moose counts.
</p>
</div>
</div>
<div class="section level2">
<h2 id="sec:discussion">Discussion<a class="anchor" aria-label="anchor" href="#sec:discussion"></a>
</h2>
<p>Throughout this vignette, we have shown several features
<code>spmodel</code> offers, including a novel application of the
Laplace approximation, similarity to base <strong>R</strong>’s function,
over a dozen spatial covariance functions, a variety of tools available
to evaluate models, inspect model diagnostics, and make predictions
using ubiquitous base <strong>R</strong> functions (e.g., , , and ) and
more. Spatial generalized linear models for point-referenced data (i.e.,
generalized geostatistical models) are fit using the function. Spatial
generalized linear models for areal data (i.e., generalized spatial
autoregressive models) are fit using the function. Both functions share
common structure and syntax. Spatial data are simulated in
<code>spmodel</code> by adding an prefix to commonly used base
<strong>R</strong> simulation functions (e.g., ).</p>
<p>We appreciate feedback from users regarding <code>spmodel</code>. To
learn more about how to provide feedback or contribute to
<code>spmodel</code>, please visit our GitHub repository at <a href="https://github.com/USEPA/spmodel" class="external-link uri">https://github.com/USEPA/spmodel</a>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-akaike1974new" class="csl-entry">
Akaike, Hirotugu. 1974. <span>“A New Look at the Statistical Model
Identification.”</span> <em>IEEE Transactions on Automatic Control</em>
19 (6): 716–23.
</div>
<div id="ref-appelhans2022mapview" class="csl-entry">
Appelhans, Tim, Florian Detsch, Christoph Reudenbach, and Stefan
Woellauer. 2022. <em>Mapview: Interactive Viewing of Spatial Data in
r</em>. <a href="https://CRAN.R-project.org/package=mapview" class="external-link">https://CRAN.R-project.org/package=mapview</a>.
</div>
<div id="ref-banerjee2014hierarchical" class="csl-entry">
Banerjee, Sudipto, Bradley P Carlin, and Alan E Gelfand. 2014.
<em>Hierarchical Modeling and Analysis for Spatial Data</em>. CRC press.
</div>
<div id="ref-bates2015lme4" class="csl-entry">
Bates, Douglas, Martin Mächler, Ben Bolker, and Steve Walker. 2015.
<span>“Fitting Linear Mixed-Effects Models Using <span class="nocase">lme4</span>.”</span> <em>Journal of Statistical
Software</em> 67 (1): 1–48. <a href="https://doi.org/10.18637/jss.v067.i01" class="external-link">https://doi.org/10.18637/jss.v067.i01</a>.
</div>
<div id="ref-bolker2009generalized" class="csl-entry">
Bolker, Benjamin M, Mollie E Brooks, Connie J Clark, Shane W Geange,
John R Poulsen, M Henry H Stevens, and Jada-Simone S White. 2009.
<span>“Generalized Linear Mixed Models: A Practical Guide for Ecology
and Evolution.”</span> <em>Trends in Ecology &amp; Evolution</em> 24
(3): 127–35.
</div>
<div id="ref-breslow1993approximate" class="csl-entry">
Breslow, Norman E, and David G Clayton. 1993. <span>“Approximate
Inference in Generalized Linear Mixed Models.”</span> <em>Journal of the
American Statistical Association</em> 88 (421): 9–25.
</div>
<div id="ref-chiles2012geostatistics" class="csl-entry">
Chiles, Jean-Paul, and Pierre Delfiner. 2012. <em>Geostatistics:
Modeling Spatial Uncertainty</em>. Vol. 713. John Wiley &amp; Sons.
</div>
<div id="ref-cook1979influential" class="csl-entry">
Cook, R Dennis. 1979. <span>“Influential Observations in Linear
Regression.”</span> <em>Journal of the American Statistical
Association</em> 74 (365): 169–74.
</div>
<div id="ref-cressie1993statistics" class="csl-entry">
Cressie, Noel. 1993. <em>Statistics for Spatial Data</em>. John Wiley
&amp; Sons.
</div>
<div id="ref-faraway2016extending" class="csl-entry">
Faraway, Julian J. 2016. <em>Extending the Linear Model with
<span>R</span>: Generalized Linear, Mixed Effects and Nonparametric
Regression Models</em>. CRC press.
</div>
<div id="ref-hastie2009elements" class="csl-entry">
Hastie, Trevor, Robert Tibshirani, Jerome H Friedman, and Jerome H
Friedman. 2009. <em>The Elements of Statistical Learning: Data Mining,
Inference, and Prediction</em>. Vol. 2. Springer.
</div>
<div id="ref-hoeting2006model" class="csl-entry">
Hoeting, Jennifer A, Richard A Davis, Andrew A Merton, and Sandra E
Thompson. 2006. <span>“Model Selection for Geostatistical
Models.”</span> <em>Ecological Applications</em> 16 (1): 87–98.
</div>
<div id="ref-lee1996hierarchical" class="csl-entry">
Lee, Youngjo, and John A Nelder. 1996. <span>“Hierarchical Generalized
Linear Models.”</span> <em>Journal of the Royal Statistical Society:
Series B (Methodological)</em> 58 (4): 619–56.
</div>
<div id="ref-mccullagh1989generalized" class="csl-entry">
McCullagh, Peter, and John A. Nelder. 1989. <em>Generalized Linear
Models, Second Edition</em>. Chapman; Hall Ltd.
</div>
<div id="ref-muller2021tibble" class="csl-entry">
Müller, Kirill, and Hadley Wickham. 2021. <em>Tibble: Simple Data
Frames</em>. <a href="https://CRAN.R-project.org/package=tibble" class="external-link">https://CRAN.R-project.org/package=tibble</a>.
</div>
<div id="ref-myers2012generalized" class="csl-entry">
Myers, Raymond H, Douglas C Montgomery, G Geoffrey Vining, and Timothy J
Robinson. 2012. <em>Generalized Linear Models: With Applications in
Engineering and the Sciences</em>. John Wiley &amp; Sons.
</div>
<div id="ref-nelder1972generalized" class="csl-entry">
Nelder, John Ashworth, and Robert WM Wedderburn. 1972.
<span>“Generalized Linear Models.”</span> <em>Journal of the Royal
Statistical Society: Series A (General)</em> 135 (3): 370–84.
</div>
<div id="ref-pebesma2018sf" class="csl-entry">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R:
Standardized Support for Spatial Vector Data</span>.”</span>
<em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009" class="external-link">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-pinheiro2006mixed" class="csl-entry">
Pinheiro, José, and Douglas Bates. 2006. <em>Mixed-Effects Models in s
and s-PLUS</em>. Springer science &amp; business media.
</div>
<div id="ref-robinson2021broom" class="csl-entry">
Robinson, David, Alex Hayes, and Simon Couch. 2021. <em><span class="nocase">broom</span>: Convert Statistical Objects into Tidy
Tibbles</em>. <a href="https://CRAN.R-project.org/package=broom" class="external-link">https://CRAN.R-project.org/package=broom</a>.
</div>
<div id="ref-schabenberger2017statistical" class="csl-entry">
Schabenberger, Oliver, and Carol A Gotway. 2017. <em>Statistical Methods
for Spatial Data Analysis</em>. CRC press.
</div>
<div id="ref-ver2023marginal" class="csl-entry">
Ver Hoef, Jay M, Eryn Blagg, Michael Dumelle, Philip M Dixon, Dale L
Zimmerman, and Paul Conn. 2023. <span>“Marginal Inference for
Hierarchical Generalized Linear Mixed Models with Patterned Covariance
Matrices Using the Laplace Approximation.”</span> <em>arXiv Preprint
arXiv:2305.02978</em>.
</div>
<div id="ref-wickham2016ggplot2" class="csl-entry">
Wickham, Hadley. 2016. <em><span class="nocase">ggplot2</span>: Elegant
Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-wood2017generalized" class="csl-entry">
Wood, Simon N. 2017. <em>Generalized Additive Models: An Introduction
with <span>R</span></em>. CRC press.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
