<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><title>Simulate a spatial normal (Gaussian) random variable — sprnorm • spmodel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a spatial normal (Gaussian) random variable — sprnorm"><meta property="og:description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basics.html">An Overview of Basic Features in spmodel</a>
    <a class="dropdown-item" href="../articles/guide.html">A Detailed Guide to spmodel</a>
    <a class="dropdown-item" href="../articles/technical.html">Technical Details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a spatial normal (Gaussian) random variable</h1>
      
      <div class="d-none name"><code>sprnorm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">sprnorm</span><span class="op">(</span>
  <span class="va">spcov_params</span>,
  mean <span class="op">=</span> <span class="fl">0</span>,
  samples <span class="op">=</span> <span class="fl">1</span>,
  <span class="va">data</span>,
  <span class="va">randcov_params</span>,
  <span class="va">partition_factor</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for exponential</span>
<span class="fu">sprnorm</span><span class="op">(</span>
  <span class="va">spcov_params</span>,
  mean <span class="op">=</span> <span class="fl">0</span>,
  samples <span class="op">=</span> <span class="fl">1</span>,
  <span class="va">data</span>,
  <span class="va">randcov_params</span>,
  <span class="va">partition_factor</span>,
  <span class="va">xcoord</span>,
  <span class="va">ycoord</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for none</span>
<span class="fu">sprnorm</span><span class="op">(</span>
  <span class="va">spcov_params</span>,
  mean <span class="op">=</span> <span class="fl">0</span>,
  samples <span class="op">=</span> <span class="fl">1</span>,
  <span class="va">data</span>,
  <span class="va">randcov_params</span>,
  <span class="va">partition_factor</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for car</span>
<span class="fu">sprnorm</span><span class="op">(</span>
  <span class="va">spcov_params</span>,
  mean <span class="op">=</span> <span class="fl">0</span>,
  samples <span class="op">=</span> <span class="fl">1</span>,
  <span class="va">data</span>,
  <span class="va">randcov_params</span>,
  <span class="va">partition_factor</span>,
  <span class="va">W</span>,
  row_st <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">M</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>spcov_params</dt>
<dd><p>An <code><a href="spcov_params.html">spcov_params()</a></code> object.</p></dd>


<dt>mean</dt>
<dd><p>A numeric vector representing the mean. <code>mean</code> must have length 1
(in which case it is recycled) or length equal
to the number of rows in <code>data</code>. The default is <code>0</code>.</p></dd>


<dt>samples</dt>
<dd><p>The number of independent samples to generate. The default
is <code>1</code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame or <code>sf</code> object containing spatial information.</p></dd>


<dt>randcov_params</dt>
<dd><p>A <code><a href="randcov_params.html">randcov_params()</a></code> object.</p></dd>


<dt>partition_factor</dt>
<dd><p>A formula indicating the partition factor.</p></dd>


<dt>...</dt>
<dd><p>Other arguments. Not used (needed for generic consistency).</p></dd>


<dt>xcoord</dt>
<dd><p>Name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>ycoord</dt>
<dd><p>Name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>W</dt>
<dd><p>Weight matrix specifying the neighboring structure used for car and
sar models. Not required if <code>data</code> are an <code>sf</code>
polygon object and <code>W</code> should be calculated internally.</p></dd>


<dt>row_st</dt>
<dd><p>A logical indicating whether row standardization be performed on
<code>W</code>. The default is <code>TRUE</code>.</p></dd>


<dt>M</dt>
<dd><p>M matrix satisfying the car symmetry condition. The car
symmetry condition states that \((I - range * W)^{-1}M\) is symmetric, where
\(I\) is an identity matrix, \(range\) is a constant that controls the
spatial dependence, <code>W</code> is the weights matrix,
and \(^{-1}\) represents the inverse operator.
<code>M</code> is required for car models
when <code>W</code> is provided and <code>row_st</code> is <code>FALSE</code>.  When <code>M</code>,
is required, the default is the identity matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>samples</code> is 1, a vector of random variables for each row of <code>data</code></p>


<p>is returned. If <code>samples</code> is greater than one, a matrix of random variables
is returned, where the rows correspond to each row of <code>data</code> and the columns
correspond to independent samples.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Random variables are simulated via the product of the covariance matrix's
square (Cholesky) root and independent standard normal random variables
with mean 0 and variance 1. Computing the square root is a significant
computational burden and likely unfeasible for sample sizes much past 10,000.
Because this square root only needs to be computed once, however, it is
nearly the sample computational cost to call <code>sprnorm()</code> for any value
of <code>samples</code>.</p>
<p>Only methods for the <code>exponential</code>, <code>none</code>, and <code>car</code>
covariance functions are documented here,
but methods exist for all other spatial covariance functions defined in
<code><a href="spcov_initial.html">spcov_initial()</a></code>. Syntax for the <code>exponential</code> method is the same
as syntax for <code>spherical</code>, <code>gaussian</code>, <code>triangular</code>,
<code>circular</code>, <code>cubic</code>, <code>pentaspherical</code>, <code>cosine</code>, <code>wave</code>,
<code>jbessel</code>, <code>gravity</code>, <code>rquad</code>, <code>magnetic</code>, <code>matern</code>,
<code>cauchy</code>, and <code>pexponential</code> methods. Syntax for
the <code>car</code> method is the same as syntax for the <code>sar</code> method. The
<code>extra</code> parameter for car and sar models is ignored when all observations have
neighbors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">spcov_params_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="spcov_params.html">spcov_params</a></span><span class="op">(</span><span class="st">"exponential"</span>, de <span class="op">=</span> <span class="fl">1</span>, ie <span class="op">=</span> <span class="fl">1</span>, range <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.3912812  0.8777097 -4.1302048  2.2797164 -0.4956502  1.6418570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -1.8932360  0.5352149  2.0619029 -0.9534150 -0.5667603 -2.5093976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  1.8618835  2.1479148 -1.3046371 -3.1207777  0.9716937  0.9996079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  2.5964685  0.7714237 -0.9661860  0.1189094  2.0509624  0.4091457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] -1.7011496  0.8097515  2.0975446  0.9428908 -0.3261922  0.7745804</span>
<span class="r-in"><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, samples <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]       [,3]        [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.872950  3.814811  1.0384786  0.34103816  0.2681738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.189090  4.323944 -0.6117392  0.01048705  2.8181024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  4.290003  2.957607 -0.6908909  1.67251457  2.8266280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  5.340555  5.852864  3.4485193  2.94876572  3.9896520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  5.563930  4.965418  3.1888953  4.48009971  3.1712655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  4.913318  7.720977  5.2389323  5.31166662  8.0997392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  8.058354 10.137098  5.2305738  6.85291246  6.7435056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  9.535089  8.115062  7.1943304  6.51618319  7.3935217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 10.667224 10.149462  9.2787007  7.53171164  7.6061350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 12.148142 10.419532  9.6816257  9.61463656 10.4043618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 10.250098 12.819001 10.1724534  9.81954247 11.2505413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 13.289633  9.902156  9.5707018 10.36823739 13.0977571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 15.171664 12.858070 10.7438697 12.26694784 14.7155336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 15.738534 13.364659 16.8171465 13.52160994 12.3949796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 17.698352 15.880055 16.8796074 14.47011690 14.1415197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 16.370792 19.142706 17.0077548 18.28717768 15.8523331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 17.582048 16.350445 15.6317371 15.51354726 16.0702756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 19.584679 16.396006 18.5562000 15.65432319 16.7338999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 20.390726 17.463722 18.2159034 18.12525404 18.1196701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 20.337776 19.564041 22.1216450 19.80567868 20.7816745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 22.126702 20.676012 20.8479439 20.36265356 23.2925062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 22.304049 23.102541 22.6000395 20.90305138 22.9828599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 23.463388 20.671360 22.8633382 20.53315107 21.3934476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] 23.997335 23.190577 23.3996608 22.74044050 22.9416516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] 26.277090 24.289272 23.6681108 24.43870779 23.2708006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] 27.271521 25.266712 25.4925351 25.54047728 29.7606836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] 27.088933 25.967296 25.0684743 26.74042523 29.0202116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] 28.818220 27.171454 27.8196242 28.90718431 28.0870971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] 29.499937 27.167490 27.3813456 30.20046857 28.2552536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] 29.001238 29.861259 28.9086623 30.52261425 28.8927787</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

