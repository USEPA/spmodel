<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><title>Simulate a spatial normal (Gaussian) random variable — sprnorm • spmodel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a spatial normal (Gaussian) random variable — sprnorm"><meta property="og:description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basics.html">An Overview of Basic Features in spmodel</a>
    <a class="dropdown-item" href="../articles/guide.html">A Detailed Guide to spmodel</a>
    <a class="dropdown-item" href="../articles/technical.html">Technical Details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/spmodel/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a spatial normal (Gaussian) random variable</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/R/sprnorm.R" class="external-link"><code>R/sprnorm.R</code></a></small>
      <div class="d-none name"><code>sprnorm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for exponential</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">xcoord</span>,</span>
<span>  <span class="va">ycoord</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for none</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for car</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  row_st <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>spcov_params</dt>
<dd><p>An <code><a href="spcov_params.html">spcov_params()</a></code> object.</p></dd>


<dt>mean</dt>
<dd><p>A numeric vector representing the mean. <code>mean</code> must have length 1
(in which case it is recycled) or length equal
to the number of rows in <code>data</code>. The default is <code>0</code>.</p></dd>


<dt>samples</dt>
<dd><p>The number of independent samples to generate. The default
is <code>1</code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame or <code>sf</code> object containing spatial information.</p></dd>


<dt>randcov_params</dt>
<dd><p>A <code><a href="randcov_params.html">randcov_params()</a></code> object.</p></dd>


<dt>partition_factor</dt>
<dd><p>A formula indicating the partition factor.</p></dd>


<dt>...</dt>
<dd><p>Other arguments. Not used (needed for generic consistency).</p></dd>


<dt>xcoord</dt>
<dd><p>Name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>ycoord</dt>
<dd><p>Name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>W</dt>
<dd><p>Weight matrix specifying the neighboring structure used for car and
sar models. Not required if <code>data</code> are an <code>sf</code>
polygon object and <code>W</code> should be calculated internally.</p></dd>


<dt>row_st</dt>
<dd><p>A logical indicating whether row standardization be performed on
<code>W</code>. The default is <code>TRUE</code>.</p></dd>


<dt>M</dt>
<dd><p>M matrix satisfying the car symmetry condition. The car
symmetry condition states that \((I - range * W)^{-1}M\) is symmetric, where
\(I\) is an identity matrix, \(range\) is a constant that controls the
spatial dependence, <code>W</code> is the weights matrix,
and \(^{-1}\) represents the inverse operator.
<code>M</code> is required for car models
when <code>W</code> is provided and <code>row_st</code> is <code>FALSE</code>.  When <code>M</code>,
is required, the default is the identity matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>samples</code> is 1, a vector of random variables for each row of <code>data</code></p>


<p>is returned. If <code>samples</code> is greater than one, a matrix of random variables
is returned, where the rows correspond to each row of <code>data</code> and the columns
correspond to independent samples.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Random variables are simulated via the product of the covariance matrix's
square (Cholesky) root and independent standard normal random variables
with mean 0 and variance 1. Computing the square root is a significant
computational burden and likely unfeasible for sample sizes much past 10,000.
Because this square root only needs to be computed once, however, it is
nearly the sample computational cost to call <code>sprnorm()</code> for any value
of <code>samples</code>.</p>
<p>Only methods for the <code>exponential</code>, <code>none</code>, and <code>car</code>
covariance functions are documented here,
but methods exist for all other spatial covariance functions defined in
<code><a href="spcov_initial.html">spcov_initial()</a></code>. Syntax for the <code>exponential</code> method is the same
as syntax for <code>spherical</code>, <code>gaussian</code>, <code>triangular</code>,
<code>circular</code>, <code>cubic</code>, <code>pentaspherical</code>, <code>cosine</code>, <code>wave</code>,
<code>jbessel</code>, <code>gravity</code>, <code>rquad</code>, <code>magnetic</code>, <code>matern</code>,
<code>cauchy</code>, and <code>pexponential</code> methods. Syntax for
the <code>car</code> method is the same as syntax for the <code>sar</code> method. The
<code>extra</code> parameter for car and sar models is ignored when all observations have
neighbors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spcov_params_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="spcov_params.html">spcov_params</a></span><span class="op">(</span><span class="st">"exponential"</span>, de <span class="op">=</span> <span class="fl">1</span>, ie <span class="op">=</span> <span class="fl">1</span>, range <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -0.473964281 -1.200513615 -0.474099910 -1.793888707 -0.074168856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] -1.508407632 -1.211535861 -1.924602152 -0.193508976 -0.002052277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  0.063011180  0.344156349 -0.948780615 -0.350705744 -0.135785096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]  0.519994308  0.689117752 -2.001440378  0.972466141 -0.792149822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21]  1.080118804  0.953985833  0.554521457  0.178454735  2.691408694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  1.269644278  3.719608898 -0.019729351 -0.230618010  1.753592644</span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, samples <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]      [,3]      [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.959814  2.361479  3.308520  3.305414  1.1401848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.705892  2.028682  3.797394  2.403564  0.7944248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  5.668380  3.247860  2.735391  2.317678  3.0010535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  6.201168  2.875584  4.450310  3.311665  5.3180126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  4.929344  5.601934  5.750809  7.620151  6.7010850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  8.100227  3.909230  7.348376  8.032601  5.3526803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  6.119970  6.532758  9.715175  7.385059  9.2246052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  8.331121  5.955490  7.177578  7.773055  7.0652128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  6.432769  9.617972  9.624435  9.692302 11.1874696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 11.857431  9.703247  8.901158 10.483929 11.9609324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  9.936470 13.472820 10.252977  9.158477 10.6531257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 12.714734 12.429776 13.707480 10.040952 11.8707936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 10.007339 13.309016 10.873372 13.023500 12.6839842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 15.502477 12.842745 14.545008 12.905959 14.4075815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 15.797439 15.474844 17.790912 15.150106 15.7532839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 16.169045 14.989811 14.970861 14.332831 15.9684165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 15.995921 18.578402 16.236862 17.415591 13.6446743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 19.327413 19.559180 16.137012 16.404407 18.5628867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 19.659653 18.957724 16.675515 19.859471 20.4956737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 19.790992 21.374007 20.973778 19.818530 19.1899627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 23.663944 19.828936 18.114615 23.033196 19.2073410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 21.510705 21.762511 21.473857 20.784469 20.7311076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 22.284473 24.106970 20.757314 21.170187 21.9569545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] 24.265006 23.562653 24.341100 23.678379 22.0388071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] 24.162281 27.092215 26.051400 21.741349 25.6761491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] 26.275020 25.108990 25.406309 24.613334 26.4534224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] 27.417955 26.135045 27.724811 24.230693 27.3768537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] 27.520851 29.906723 29.010994 25.785666 27.1210973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] 28.927303 29.892832 30.445955 28.424295 29.8437689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] 29.870487 29.358744 28.671426 30.591777 31.6219468</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

