<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><title>Simulate a spatial normal (Gaussian) random variable — sprnorm • spmodel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a spatial normal (Gaussian) random variable — sprnorm"><meta property="og:description" content="Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basics.html">An Overview of Basic Features in spmodel</a>
    <a class="dropdown-item" href="../articles/guide.html">A Detailed Guide to spmodel</a>
    <a class="dropdown-item" href="../articles/technical.html">Technical Details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/spmodel/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a spatial normal (Gaussian) random variable</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/R/sprnorm.R" class="external-link"><code>R/sprnorm.R</code></a></small>
      <div class="d-none name"><code>sprnorm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for exponential</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">xcoord</span>,</span>
<span>  <span class="va">ycoord</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for none</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for car</span></span>
<span><span class="fu">sprnorm</span><span class="op">(</span></span>
<span>  <span class="va">spcov_params</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">randcov_params</span>,</span>
<span>  <span class="va">partition_factor</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  row_st <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>spcov_params</dt>
<dd><p>An <code><a href="spcov_params.html">spcov_params()</a></code> object.</p></dd>


<dt>mean</dt>
<dd><p>A numeric vector representing the mean. <code>mean</code> must have length 1
(in which case it is recycled) or length equal
to the number of rows in <code>data</code>. The default is <code>0</code>.</p></dd>


<dt>samples</dt>
<dd><p>The number of independent samples to generate. The default
is <code>1</code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame or <code>sf</code> object containing spatial information.</p></dd>


<dt>randcov_params</dt>
<dd><p>A <code><a href="randcov_params.html">randcov_params()</a></code> object.</p></dd>


<dt>partition_factor</dt>
<dd><p>A formula indicating the partition factor.</p></dd>


<dt>...</dt>
<dd><p>Other arguments. Not used (needed for generic consistency).</p></dd>


<dt>xcoord</dt>
<dd><p>Name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>ycoord</dt>
<dd><p>Name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p></dd>


<dt>W</dt>
<dd><p>Weight matrix specifying the neighboring structure used for car and
sar models. Not required if <code>data</code> are an <code>sf</code>
polygon object and <code>W</code> should be calculated internally (using queen contiguity).</p></dd>


<dt>row_st</dt>
<dd><p>A logical indicating whether row standardization be performed on
<code>W</code>. The default is <code>TRUE</code>.</p></dd>


<dt>M</dt>
<dd><p>M matrix satisfying the car symmetry condition. The car
symmetry condition states that \((I - range * W)^{-1}M\) is symmetric, where
\(I\) is an identity matrix, \(range\) is a constant that controls the
spatial dependence, <code>W</code> is the weights matrix,
and \(^{-1}\) represents the inverse operator.
<code>M</code> is required for car models
when <code>W</code> is provided and <code>row_st</code> is <code>FALSE</code>.  When <code>M</code>,
is required, the default is the identity matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>samples</code> is 1, a vector of random variables for each row of <code>data</code></p>


<p>is returned. If <code>samples</code> is greater than one, a matrix of random variables
is returned, where the rows correspond to each row of <code>data</code> and the columns
correspond to independent samples.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Random variables are simulated via the product of the covariance matrix's
square (Cholesky) root and independent standard normal random variables
with mean 0 and variance 1. Computing the square root is a significant
computational burden and likely unfeasible for sample sizes much past 10,000.
Because this square root only needs to be computed once, however, it is
nearly the sample computational cost to call <code>sprnorm()</code> for any value
of <code>samples</code>.</p>
<p>Only methods for the <code>exponential</code>, <code>none</code>, and <code>car</code>
covariance functions are documented here,
but methods exist for all other spatial covariance functions defined in
<code><a href="spcov_initial.html">spcov_initial()</a></code>. Syntax for the <code>exponential</code> method is the same
as syntax for <code>spherical</code>, <code>gaussian</code>, <code>triangular</code>,
<code>circular</code>, <code>cubic</code>, <code>pentaspherical</code>, <code>cosine</code>, <code>wave</code>,
<code>jbessel</code>, <code>gravity</code>, <code>rquad</code>, <code>magnetic</code>, <code>matern</code>,
<code>cauchy</code>, and <code>pexponential</code> methods. Syntax for
the <code>car</code> method is the same as syntax for the <code>sar</code> method. The
<code>extra</code> parameter for car and sar models is ignored when all observations have
neighbors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spcov_params_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="spcov_params.html">spcov_params</a></span><span class="op">(</span><span class="st">"exponential"</span>, de <span class="op">=</span> <span class="fl">1</span>, ie <span class="op">=</span> <span class="fl">1</span>, range <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.23349423  2.12575784  0.98817290 -1.78892120 -1.28678320 -0.63362264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -0.82059580  2.37982075  0.46615743  2.82006260  0.17180381 -0.87118299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] -1.69682481  1.27065415  1.88133665  1.68000680 -0.01153944 -1.73281688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] -1.10583271 -1.09570753  0.82339135  1.61871390 -0.19397140 -1.10240843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] -0.55185459  1.03933008  0.09506606 -1.03082715 -2.24406182 -2.59429104</span>
<span class="r-in"><span><span class="fu">sprnorm</span><span class="op">(</span><span class="va">spcov_params_val</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, samples <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">caribou</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]      [,3]      [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.528083  0.7703245  1.722417  2.429180 -0.6652816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  1.799518  1.0150236  3.968203  3.813322  1.3440317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  2.678239  1.0913940  2.213606  3.428126  4.0833516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.865541  2.0443124  5.112626  2.856614  3.1451557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  2.517346  5.3680605  5.544207  5.702143  6.5841828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  7.231810  5.6476596  6.090334  7.002619  3.8896299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  7.238252  8.4750326  6.391873  7.376044  8.7161865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  7.365753  6.7724488  5.653785  6.486235  5.7240857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  7.854739  8.7908037  8.293750  9.046280  8.6750041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 11.420877  8.1292646  9.133496 12.753457 12.1230740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 10.074353 10.3532001  9.457402 10.523221  8.9749191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 10.753295 11.9407482  9.849835 12.563811 11.8429336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 11.184922 14.2850012 14.174044 11.772692 13.0241812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 11.744046 14.8355656 11.754424 14.101684 15.1884856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 14.477492 14.2241853 14.998525 16.305557 15.5878442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 15.542840 13.9935528 14.735531 17.970287 15.9918663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 14.485220 18.9555527 16.431921 16.798546 16.7995965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 18.028339 17.6749548 18.208921 18.473442 17.6009399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 21.534036 20.3600206 18.891205 20.838431 18.9532774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 20.972658 21.6627229 20.591763 21.882818 19.7179787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 19.442234 22.0256617 21.443533 20.615684 22.0036001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 22.150830 21.4046788 22.287592 19.364185 19.2283562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 23.637628 23.2833634 22.493463 20.829445 22.2427017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] 25.140054 25.0016260 23.356456 24.835558 25.2346133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] 25.012462 26.8574702 27.689026 24.826478 24.0999552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] 27.994622 26.9697075 27.823406 23.080754 24.5108520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] 28.250463 26.7327525 26.546732 24.964274 24.8147699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] 27.666385 27.0834780 28.936417 31.506135 26.7133213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] 28.469509 30.1375615 29.534090 30.659416 28.2522673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] 30.760192 31.7687738 31.264848 30.938891 29.1911678</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

