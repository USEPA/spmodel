<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spmodel">
<title>An Overview of Basic Features in spmodel • spmodel</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Overview of Basic Features in spmodel">
<meta property="og:description" content="spmodel">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basics.html">An Overview of Basic Features in spmodel</a>
    <a class="dropdown-item" href="../articles/guide.html">A Detailed Guide to spmodel</a>
    <a class="dropdown-item" href="../articles/technical.html">Technical Details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/spmodel/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="basics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>An Overview of Basic Features in spmodel</h1>
                        <h4 data-toc-skip class="author">Michael Dumelle, Matt Higham, and Jay M. Ver Hoef</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/USEPA/spmodel/blob/HEAD/vignettes/basics.Rmd" class="external-link"><code>vignettes/basics.Rmd</code></a></small>
      <div class="d-none name"><code>basics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>spmodel</code> package is used to fit and summarize spatial models and make predictions at unobserved locations (Kriging). This vignette provides an overview of basic features in <code>spmodel</code>. We load <code>spmodel</code> by running</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usepa.github.io/spmodel/" class="external-link">spmodel</a></span><span class="op">)</span></span></code></pre></div>
<p>If you use <code>spmodel</code> in a formal publication or report, please cite it. Citing <code>spmodel</code> lets us devote more resources to it in the future. We view the <code>spmodel</code> citation by running</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"spmodel"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To cite spmodel in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Michael Dumelle, Matt Higham, and Jay M. Ver Hoef (2022). spmodel:</span></span>
<span><span class="co">#&gt;   Spatial Statistical Modeling and Prediction. R package version 0.2.0.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   @Manual{,</span></span>
<span><span class="co">#&gt;     title = {spmodel: Spatial Statistical Modeling and Prediction},</span></span>
<span><span class="co">#&gt;     author = {Michael Dumelle and Matt Higham and Jay M. {Ver Hoef}},</span></span>
<span><span class="co">#&gt;     year = {2022},</span></span>
<span><span class="co">#&gt;     note = {R package version 0.2.0},</span></span>
<span><span class="co">#&gt;   }</span></span></code></pre>
<p>There are two additional <code>spmodel</code> vignettes:</p>
<ul>
<li>A detailed guide to <code>spmodel</code>: <code><a href="../articles/guide.html">vignette("guide", "spmodel")</a></code>
</li>
<li>Technical details regarding many functions: <code><a href="../articles/technical.html">vignette("technical", "spmodel")</a></code>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="the-data">The Data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h2>
<p>Many of the data sets we use in this vignette are <code>sf</code> objects. <code>sf</code> objects are data frames (or tibbles) with a special structure that stores spatial information. They are built using the sf <span class="citation">(Pebesma 2018)</span> package, which is installed alongside <code>spmodel</code>. We will use four data sets throughout this vignette:</p>
<ul>
<li>
<code>moss</code>: An <code>sf</code> object with heavy metal concentrations in Alaska.</li>
<li>
<code>sulfate</code>: An <code>sf</code> object with sulfate measurements in the conterminous United States.</li>
<li>
<code>sulfate_preds</code>: An <code>sf</code> object with locations at which to predict sulfate measurements in the conterminous United States.</li>
<li>
<code>caribou</code>: A <code>tibble</code> (a special <code>data.frame</code>) for a caribou foraging experiment in Alaska.</li>
</ul>
<p>We will create visualizations using ggplot2 <span class="citation">(Wickham 2016)</span>, which we load by running</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>ggplot2 is only installed alongside <code>spmodel</code> when <code>dependencies = TRUE</code> in <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>, so check that it is installed before reproducing any visualizations in this vignette.</p>
</div>
<div class="section level2">
<h2 id="spatial-linear-models">Spatial Linear Models<a class="anchor" aria-label="anchor" href="#spatial-linear-models"></a>
</h2>
<p>Spatial linear models for a quantitative response vector <span class="math inline">\(\mathbf{y}\)</span> have spatially dependent random errors and are often parameterized as</p>
<p><span class="math display">\[\begin{equation*}
\mathbf{y} = \mathbf{X} \boldsymbol{\beta} + \boldsymbol{\tau} + \boldsymbol{\epsilon},
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}\)</span> is a matrix of explanatory variables (usually including a column of 1’s for an intercept), <span class="math inline">\(\boldsymbol{\beta}\)</span> is a vector of fixed effects that describe the average impact of <span class="math inline">\(\mathbf{X}\)</span> on <span class="math inline">\(\mathbf{y}\)</span>, <span class="math inline">\(\boldsymbol{\tau}\)</span> is a vector of spatially dependent (correlated) random errors, and <span class="math inline">\(\boldsymbol{\epsilon}\)</span> is a vector of spatially independent (uncorrelated) random errors. The spatial dependence of <span class="math inline">\(\boldsymbol{\tau}\)</span> is explicitly specified using a spatial covariance function that incorporates the variance of <span class="math inline">\(\boldsymbol{\tau}\)</span>, often called the partial sill, and a range parameter that controls the behavior of the spatial covariance. The variance of <span class="math inline">\(\boldsymbol{\epsilon}\)</span> is often called the nugget.</p>
<p>Spatial linear models are fit in <code>spmodel</code> for point-referenced and areal data. Data are point-referenced when the elements in <span class="math inline">\(\mathbf{y}\)</span> are observed at point-locations indexed by x-coordinates and y-coordinates on a spatially continuous surface with an infinite number of locations. The <code><a href="../reference/splm.html">splm()</a></code> function is used to fit spatial linear models for point-referenced data (these are often called geostatistical models). Data are areal when the elements in <span class="math inline">\(\mathbf{y}\)</span> are observed as part of a finite network of polygons whose connections are indexed by a neighborhood structure. For example, the polygons may represent counties in a state who are neighbors if they share at least one boundary. The <code><a href="../reference/spautor.html">spautor()</a></code> function is used to fit spatial linear models for areal data (these are often called spatial autoregressive models). This vignette focuses on spatial linear models for point-referenced data, though <code>spmodel</code>’s other vignettes discuss spatial linear models for areal data.</p>
<p>The <code><a href="../reference/splm.html">splm()</a></code> function has similar syntax and output as the commonly used <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function used to fit non-spatial linear models. <code><a href="../reference/splm.html">splm()</a></code> generally requires at least three arguments:</p>
<ul>
<li>
<code>formula</code>: a formula that describes the relationship between the response variable and explanatory variables.
<ul>
<li>
<code>formula</code> uses the same syntax as the <code>formula</code> argument in <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
</li>
</ul>
</li>
<li>
<code>data</code>: a <code>data.frame</code> or <code>sf</code> object that contains the response variable, explanatory variables, and spatial information.</li>
<li>
<code>spcov_type</code>: the spatial covariance type (<code>"exponential"</code>, <code>"spherical"</code>, <code>"matern"</code>, etc).</li>
</ul>
<p>If <code>data</code> is an <code>sf</code> object, the coordinate information is taken from the object’s geometry. If <code>data</code> is a <code>data.frame</code> (or <code>tibble</code>), then <code>xcoord</code> and <code>ycoord</code> are required arguments to <code><a href="../reference/splm.html">splm()</a></code> that specify the columns in <code>data</code> representing the x-coordinates and y-coordinates, respectively. <code>spmodel</code> uses the spatial coordinates “as-is,” meaning that <code>spmodel</code> does not perform any projections. To project your data or change the coordinate reference system, use <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">sf::st_transform()</a></code>. If an <code>sf</code> object with polygon geometries is given to <code><a href="../reference/splm.html">splm()</a></code>, the centroids of each polygon are used to fit the spatial linear model.</p>
<p>Next we show the basic features and syntax of <code><a href="../reference/splm.html">splm()</a></code> using the Alaskan <code>moss</code> data. We study the impact of log distance to the road (<code>log_dist2road</code>) on log zinc concentration (<code>log_Zn</code>). We view the first few rows of the <code>moss</code> data by running</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moss</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 365 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -445884.1 ymin: 1929616 xmax: -383656.8 ymax: 2061414</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / Alaska Albers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 365 x 8</span></span></span>
<span><span class="co">#&gt;    sample field_dup lab_rep year  sideroad log_dist2road log_Zn</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 001PR  1         1       2001  N                 2.68   7.33</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 001PR  1         2       2001  N                 2.68   7.38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 002PR  1         1       2001  N                 2.54   7.58</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 003PR  1         1       2001  N                 2.97   7.63</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 004PR  1         1       2001  N                 2.72   7.26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 005PR  1         1       2001  N                 2.76   7.65</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 006PR  1         1       2001  S                 2.30   7.59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 007PR  1         1       2001  N                 2.78   7.16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 008PR  1         1       2001  N                 2.93   7.19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 009PR  1         1       2001  N                 2.79   8.07</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 355 more rows, and 1 more variable: geometry &lt;POINT [m]&gt;</span></span></span></code></pre>
<p>We can visualize the distribution of log zinc concentration (<code>log_Zn</code>) by running</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">moss</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">log_Zn</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="basics_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Log zinc concentration appears highest in the middle of the spatial domain, which has a road running through it. We fit a spatial linear model regressing log zinc concentration on log distance to the road using an exponential spatial covariance function by running</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splm.html">splm</a></span><span class="op">(</span><span class="va">log_Zn</span> <span class="op">~</span> <span class="va">log_dist2road</span>, data <span class="op">=</span> <span class="va">moss</span>, spcov_type <span class="op">=</span> <span class="st">"exponential"</span><span class="op">)</span></span></code></pre></div>
<p>The estimation method is specified via the <code>estmethod</code> argument, which has a default value of <code>"reml"</code> for restricted maximum likelihood. Other estimation methods are <code>"ml"</code> for maximum likelihood, <code>"sv-wls"</code> for semivariogram weighted least squares, and <code>"sv-cl"</code> for semivariogram composite likelihood.</p>
<p>Printing <code>spmod</code> shows the function call, the estimated fixed effect coefficients, and the estimated spatial covariance parameters. <code>de</code> is the estimated variance of <span class="math inline">\(\boldsymbol{\tau}\)</span> (the spatially dependent random error), <code>ie</code> is the estimated variance of <span class="math inline">\(\boldsymbol{\epsilon}\)</span> (the spatially independent random error), and <code>range</code> is the range parameter.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">spmod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; splm(formula = log_Zn ~ log_dist2road, data = moss, spcov_type = "exponential")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (fixed):</span></span>
<span><span class="co">#&gt;   (Intercept)  log_dist2road  </span></span>
<span><span class="co">#&gt;        9.7683        -0.5629  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (exponential spatial covariance):</span></span>
<span><span class="co">#&gt;        de         ie      range  </span></span>
<span><span class="co">#&gt; 3.595e-01  7.897e-02  8.237e+03</span></span></code></pre>
<p>Next we show how to obtain more detailed summary information from the fitted model.</p>
<div class="section level3">
<h3 id="model-summaries">Model Summaries<a class="anchor" aria-label="anchor" href="#model-summaries"></a>
</h3>
<p>We summarize the fitted model by running</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">spmod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; splm(formula = log_Zn ~ log_dist2road, data = moss, spcov_type = "exponential")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.6801 -1.3606 -0.8103 -0.2485  1.1298 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (fixed):</span></span>
<span><span class="co">#&gt;               Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)    9.76825    0.25216   38.74   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; log_dist2road -0.56287    0.02013  -27.96   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pseudo R-squared: 0.683</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (exponential spatial covariance):</span></span>
<span><span class="co">#&gt;        de        ie     range </span></span>
<span><span class="co">#&gt; 3.595e-01 7.897e-02 8.237e+03</span></span></code></pre>
<p>Similar to summaries of <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> objects, summaries of <code><a href="../reference/splm.html">splm()</a></code> objects include the original function call, residuals, and a coefficients table of fixed effects. Log zinc concentration appears to significantly decrease with log distance from the road, as evidenced by the small p-value associated with the asymptotic z-test. A pseudo r-squared is also returned, which quantifies the proportion of variability explained by the fixed effects.</p>
<p>In the remainder of this subsection, we describe the broom <span class="citation">(Robinson, Hayes, and Couch 2021)</span> functions <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>, <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> and <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code>. <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> tidies coefficient output in a convenient <code>tibble</code>, <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> glances at model-fit statistics, and <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> augments the data with fitted model diagnostics.</p>
<p>We tidy the fixed effects by running</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">spmod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 5</span></span></span>
<span><span class="co">#&gt;   term          estimate std.error statistic p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> (Intercept)      9.77     0.252       38.7       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> log_dist2road   -<span style="color: #BB0000;">0.563</span>    0.020<span style="text-decoration: underline;">1</span>     -<span style="color: #BB0000;">28.0</span>       0</span></span></code></pre>
<p>We glance at the model-fit statistics by running</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">spmod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 9</span></span></span>
<span><span class="co">#&gt;       n     p  npar value   AIC  AICc logLik deviance pseudo.r.squared</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   365     2     3  367.  373.  373.  -<span style="color: #BB0000;">184.</span>      363            0.683</span></span></code></pre>
<p>The columns of this <code>tibble</code> represent:</p>
<ul>
<li>
<code>n</code>: The sample size</li>
<li>
<code>p</code>: The number of fixed effects (linearly independent columns in <span class="math inline">\(\mathbf{X}\)</span>)</li>
<li>
<code>npar</code>: The number of estimated covariance parameters</li>
<li>
<code>value</code>: The value of the minimized objective function used when fitting the model</li>
<li>
<code>AIC</code>: The Akaike Information Criterion (AIC)</li>
<li>
<code>AICc</code>: The AIC with a small sample size correction</li>
<li>
<code>logLik</code>: The log-likelihood</li>
<li>
<code>deviance</code>: The deviance</li>
<li>
<code>pseudo.r.squared</code>: The pseudo r-squared</li>
</ul>
<p>The <code><a href="../reference/glances.html">glances()</a></code> function can be used to glance at multiple models at once. Suppose we wanted to compare the current model, which uses an exponential spatial covariance, to a new model without spatial covariance (equivalent to a model fit using <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>). We do this using <code><a href="../reference/glances.html">glances()</a></code> by running</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splm.html">splm</a></span><span class="op">(</span><span class="va">log_Zn</span> <span class="op">~</span> <span class="va">log_dist2road</span>, data <span class="op">=</span> <span class="va">moss</span>, spcov_type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/glances.html">glances</a></span><span class="op">(</span><span class="va">spmod</span>, <span class="va">lmod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 10</span></span></span>
<span><span class="co">#&gt;   model     n     p  npar value   AIC  AICc logLik deviance pseudo.r.squared</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> spmod   365     2     3  367.  373.  373.  -<span style="color: #BB0000;">184.</span>     363             0.683</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> lmod    365     2     1  634.  636.  636.  -<span style="color: #BB0000;">317.</span>     363.            0.671</span></span></code></pre>
<p>The much lower AIC and AICc for the spatial linear model indicates it is a much better fit to the data. Outside of <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> and <code><a href="../reference/glances.html">glances()</a></code>, the functions <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code>, <code><a href="../reference/AIC.spmod.html">AICc()</a></code>, <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code>, <code><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance()</a></code>, and <code><a href="../reference/pseudoR2.html">pseudoR2()</a></code> are available to compute the relevant statistics.</p>
<p>We augment the data with diagnostics by running</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">spmod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 365 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -445884.1 ymin: 1929616 xmax: -383656.8 ymax: 2061414</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / Alaska Albers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 365 x 8</span></span></span>
<span><span class="co">#&gt;    log_Zn log_dist2road .fitted .resid    .hat  .cooksd .std.resid</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   7.33          2.68    8.26 -<span style="color: #BB0000;">0.928</span> 0.102   0.112        -<span style="color: #BB0000;">1.48</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   7.38          2.68    8.26 -<span style="color: #BB0000;">0.880</span> 0.010<span style="text-decoration: underline;">1</span>  0.000<span style="text-decoration: underline;">507</span>     -<span style="color: #BB0000;">0.316</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   7.58          2.54    8.34 -<span style="color: #BB0000;">0.755</span> 0.017<span style="text-decoration: underline;">0</span>  0.000<span style="text-decoration: underline;">475</span>     -<span style="color: #BB0000;">0.236</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   7.63          2.97    8.09 -<span style="color: #BB0000;">0.464</span> 0.013<span style="text-decoration: underline;">7</span>  0.000<span style="text-decoration: underline;">219</span>      0.178</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   7.26          2.72    8.24 -<span style="color: #BB0000;">0.977</span> 0.017<span style="text-decoration: underline;">7</span>  0.005<span style="text-decoration: underline;">15</span>      -<span style="color: #BB0000;">0.762</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   7.65          2.76    8.21 -<span style="color: #BB0000;">0.568</span> 0.014<span style="text-decoration: underline;">7</span>  0.000<span style="text-decoration: underline;">929</span>     -<span style="color: #BB0000;">0.355</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   7.59          2.30    8.47 -<span style="color: #BB0000;">0.886</span> 0.017<span style="text-decoration: underline;">0</span>  0.008<span style="text-decoration: underline;">02</span>      -<span style="color: #BB0000;">0.971</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   7.16          2.78    8.20 -<span style="color: #BB0000;">1.05</span>  0.059<span style="text-decoration: underline;">3</span>  0.049<span style="text-decoration: underline;">2</span>       -<span style="color: #BB0000;">1.29</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   7.19          2.93    8.12 -<span style="color: #BB0000;">0.926</span> 0.007<span style="text-decoration: underline;">93</span> 0.000<span style="text-decoration: underline;">451</span>     -<span style="color: #BB0000;">0.337</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   8.07          2.79    8.20 -<span style="color: #BB0000;">0.123</span> 0.026<span style="text-decoration: underline;">5</span>  0.003<span style="text-decoration: underline;">96</span>       0.547</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 355 more rows, and 1 more variable: geometry &lt;POINT [m]&gt;</span></span></span></code></pre>
<p>The columns of this tibble represent:</p>
<ul>
<li>
<code>log_Zn</code>: The log zinc concentration.</li>
<li>
<code>log_dist2road</code>: The log distance to the road.</li>
<li>
<code>.fitted</code>: The fitted values (the estimated mean given the explanatory variable values).</li>
<li>
<code>.resid</code>: The residuals (the response minus the fitted values).</li>
<li>
<code>.hat</code>: The leverage (hat) values.</li>
<li>
<code>.cooksd</code>: The Cook’s distance</li>
<li>
<code>.std.residuals</code>: Standardized residuals</li>
<li>
<code>geometry</code>: The spatial information in the <code>sf</code> object.</li>
</ul>
<p>By default, <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> only returns the variables in the data used by the model. All variables from the original data are returned by setting <code>drop = FALSE</code>. Many of these model diagnostics can be visualized by running <code>plot(spmod)</code>. We can learn more about <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> in <code>spmodel</code> by running <code><a href="../reference/plot.spmod.html">help("plot.spmod", "spmodel")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="prediction-kriging">Prediction (Kriging)<a class="anchor" aria-label="anchor" href="#prediction-kriging"></a>
</h3>
<p>Commonly a goal of a data analysis is to make predictions at unobserved locations. In spatial contexts, prediction is often called Kriging. Next we use the <code>sulfate</code> data to build a spatial linear model of sulfate measurements in the conterminous United States with the goal of making sulfate predictions (Kriging) for the unobserved locations in <code>sulfate_preds</code>.</p>
<p>We visualize the distribution of <code>sulfate</code> by running</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sulfate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">sulfate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="basics_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Sulfate appears spatially dependent, as measurements are highest in the Northeast and lowest in the Midwest and West.</p>
<p>We fit a spatial linear model regressing sulfate on an intercept using a spherical spatial covariance function by running</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sulfmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splm.html">splm</a></span><span class="op">(</span><span class="va">sulfate</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">sulfate</span>, spcov_type <span class="op">=</span>  <span class="st">"spherical"</span><span class="op">)</span></span></code></pre></div>
<p>We make predictions at the locations in <code>sulfate_preds</code> and store them as a new variable called <code>preds</code> in the <code>sulfate_preds</code> data set by running</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sulfate_preds</span><span class="op">$</span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sulfmod</span>, newdata <span class="op">=</span> <span class="va">sulfate_preds</span><span class="op">)</span></span></code></pre></div>
<p>We visualize these predictions by running</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sulfate_preds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">preds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="basics_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>These predictions have similar sulfate patterns as in the observed data (predicted values are highest in the Northeast and lowest in the Midwest and West). Next we remove the model predictions from <code>sulfate_preds</code> before showing how <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> can be used to obtain the same predictions:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sulfate_preds</span><span class="op">$</span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>While <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> was previously used to augment the original data with model diagnostics, it can also be used to augment the <code>newdata</code> data with predictions:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">sulfmod</span>, newdata <span class="op">=</span> <span class="va">sulfate_preds</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 100 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -2283774 ymin: 582930.5 xmax: 1985906 ymax: 3037173</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / Conus Albers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 x 2</span></span></span>
<span><span class="co">#&gt;    .fitted            geometry</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    1.40  (-1771413 1752976)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   24.5    (1018112 1867127)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    8.99 (-291256.8 1553212)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   16.4    (1274293 1267835)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    4.91 (-547437.6 1638825)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   26.7    (1445080 1981278)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    3.00  (-1629090 3037173)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   14.3    (1302757 1039534)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    1.49  (-1429838 2523494)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   14.4    (1131970 1096609)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 90 more rows</span></span></span></code></pre>
<p>Here <code>.fitted</code> represents the predictions.</p>
<p>Confidence intervals for the mean response or prediction intervals for the predicted response can be obtained by specifying the <code>interval</code> argument in <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> and <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">sulfmod</span>, newdata <span class="op">=</span> <span class="va">sulfate_preds</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 100 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -2283774 ymin: 582930.5 xmax: 1985906 ymax: 3037173</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / Conus Albers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 x 4</span></span></span>
<span><span class="co">#&gt;    .fitted .lower .upper            geometry</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    1.40  -<span style="color: #BB0000;">6.62</span>   9.42  (-1771413 1752976)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   24.5   17.0   32.0    (1018112 1867127)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    8.99   1.09  16.9  (-291256.8 1553212)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   16.4    8.67  24.2    (1274293 1267835)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    4.91  -<span style="color: #BB0000;">2.80</span>  12.6  (-547437.6 1638825)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   26.7   19.2   34.2    (1445080 1981278)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    3.00  -<span style="color: #BB0000;">4.92</span>  10.9   (-1629090 3037173)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   14.3    6.76  21.8    (1302757 1039534)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    1.49  -<span style="color: #BB0000;">6.34</span>   9.32  (-1429838 2523494)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   14.4    6.74  22.1    (1131970 1096609)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 90 more rows</span></span></span></code></pre>
<p>By default, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> and <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> compute 95% intervals, though this can be changed using the <code>level</code> argument.</p>
<p>While the fitted model in this example only used an intercept, the same code is used for prediction with fitted models having explanatory variables. If explanatory variables were used to fit the model, the same explanatory variables must be included in <code>newdata</code> with the same names they have in <code>data</code>. If <code>data</code> is a <code>data.frame</code>, coordinates must be included in <code>newdata</code> with the same names as they have in <code>data</code>. If <code>data</code> is an <code>sf</code> object, coordinates must be included in <code>newdata</code> with the same geometry name as they have in <code>data</code>. When using projected coordinates, the projection for <code>newdata</code> should be the same as the projection for <code>data</code>.</p>
</div>
<div class="section level3">
<h3 id="an-additional-example">An Additional Example<a class="anchor" aria-label="anchor" href="#an-additional-example"></a>
</h3>
<p>We now use the <code>caribou</code> data from a foraging experiment conducted in Alaska to show an application of <code><a href="../reference/splm.html">splm()</a></code> to data stored in a <code>tibble</code> (<code>data.frame</code>) instead of an <code>sf</code> object. In <code>caribou</code>, the x-coordinates are stored in the <code>x</code> column and the y-coordinates are stored in the <code>y</code> column. We view the first few rows of <code>caribou</code> by running</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caribou</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 x 5</span></span></span>
<span><span class="co">#&gt;    water tarp      z     x     y</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Y     clear  2.42     1     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Y     shade  2.44     2     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Y     none   1.81     3     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> N     clear  1.97     4     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> N     shade  2.38     5     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Y     none   2.22     1     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> N     clear  2.10     2     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Y     clear  1.80     3     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Y     shade  1.96     4     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Y     none   2.10     5     5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 20 more rows</span></span></span></code></pre>
<p>We fit a spatial linear model regressing nitrogen percentage (<code>z</code>) on water presence (<code>water</code>) and tarp cover (<code>tarp</code>) by running</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cariboumod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splm.html">splm</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">water</span> <span class="op">+</span> <span class="va">tarp</span>, data <span class="op">=</span> <span class="va">caribou</span>,</span>
<span>                   spcov_type <span class="op">=</span> <span class="st">"exponential"</span>, xcoord <span class="op">=</span> <span class="va">x</span>, ycoord <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>An analysis of variance can be conducted to assess the overall impact of the <code>tarp</code> variable, which has three levels (clear, shade, and none), and the <code>water</code> variable, which has two levels (water and no water). We perform an analysis of variance by running</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">cariboumod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: z</span></span>
<span><span class="co">#&gt;             Df    Chi2 Pr(&gt;Chi2)    </span></span>
<span><span class="co">#&gt; (Intercept)  1 43.4600 4.327e-11 ***</span></span>
<span><span class="co">#&gt; water        1  1.6603 0.1975631    </span></span>
<span><span class="co">#&gt; tarp         2 15.4071 0.0004512 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>There seems to be significant evidence that at least one tarp cover impacts nitrogen. Note that, like in <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, these p-values are associated with an asymptotic hypothesis test (here, an asymptotic Chi-squared test).</p>
</div>
</div>
<div class="section level2">
<h2 id="function-glossary">Function Glossary<a class="anchor" aria-label="anchor" href="#function-glossary"></a>
</h2>
<p>Here we list some commonly used <code>spmodel</code> functions.</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code>: Compute the AIC.</li>
<li>
<code><a href="../reference/AIC.spmod.html">AICc()</a></code>: Compute the AICc.</li>
<li>
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code>: Perform an analysis of variance.</li>
<li>
<code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code>: Augment data with diagnostics or new data with predictions.</li>
<li>
<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>: Return coefficients.</li>
<li>
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>: Compute confidence intervals.</li>
<li>
<code><a href="../reference/covmatrix.html">covmatrix()</a></code>: Return covariance matrices.</li>
<li>
<code><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance()</a></code>: Compute the deviance.</li>
<li>
<code><a href="../reference/esv.html">esv()</a></code>: Compute an empirical semivariogram.</li>
<li>
<code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code>: Compute fitted values.</li>
<li>
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code>: Glance at a fitted model.</li>
<li>
<code><a href="../reference/glances.html">glances()</a></code>: Glance at multiple fitted models.</li>
<li>
<code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hatvalues()</a></code>: Compute leverage (hat) values.</li>
<li>
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code>: Compute the log-likelihood.</li>
<li>
<code><a href="../reference/loocv.html">loocv()</a></code>: Perform leave-one-out cross validation.</li>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>: Create fitted model plots.</li>
<li>
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>: Compute predictions and prediction intervals.</li>
<li>
<code><a href="../reference/pseudoR2.html">pseudoR2()</a></code>: Compute the pseudo r-squared.</li>
<li>
<code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code>: Compute residuals.</li>
<li>
<code><a href="../reference/spautor.html">spautor()</a></code>: Fit a spatial linear model for areal data (i.e., spatial autoregressive model).</li>
<li>
<code><a href="../reference/spautorRF.html">spautorRF()</a></code>: Fit a random forest spatial residual model for areal data.</li>
<li>
<code><a href="../reference/splm.html">splm()</a></code>: Fit a spatial linear model for point-referenced data (i.e., geostatistical model).</li>
<li>
<code><a href="../reference/splmRF.html">splmRF()</a></code>: Fit a random forest spatial residual model for point-referenced data.</li>
<li>
<code><a href="../reference/sprnorm.html">sprnorm()</a></code>: Simulate spatially correlated normal (Gaussian) random variables.</li>
<li>
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>: Summarize fitted models.</li>
<li>
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>: Tidy fitted models.</li>
<li>
<code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code>: Compute variance-covariance matrices of estimated parameters.</li>
</ul>
<p>For a full list of <code>spmodel</code> functions alongside their documentation, see the documentation manual.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs">
<div id="ref-pebesma2018sf">
<p>Pebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” <em>The R Journal</em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009" class="external-link">https://doi.org/10.32614/RJ-2018-009</a>.</p>
</div>
<div id="ref-robinson2021broom">
<p>Robinson, David, Alex Hayes, and Simon Couch. 2021. <em>Broom: Convert Statistical Objects into Tidy Tibbles</em>. <a href="https://CRAN.R-project.org/package=broom" class="external-link">https://CRAN.R-project.org/package=broom</a>.</p>
</div>
<div id="ref-wickham2016ggplot2">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Dumelle, Matt Higham, Jay M. Ver Hoef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
